import{r as s,j as a,bt as x,aP as d,i as g,aL as m,bu as p,bv as v}from"./index-CfqNPLkZ.js";import{a as u}from"./authStore-DTSzeeqX.js";function j({children:e}){const[o]=s.useState(()=>u);return a.jsx(x.Provider,{value:o,children:e})}function A(){const{token:e,tokenExpiration:o,logout:r}=d(u,t=>t),n=g(t=>t.isLoading),c=m(),l=s.useRef(n);s.useEffect(()=>{l.current=n},[n]);const i=s.useCallback(()=>{const t=()=>{l.current?setTimeout(t,500):(r(),c("/login"))};t()},[r,c]);return s.useEffect(()=>{if(!e||!o)return;const t=Date.now(),f=o-t;if(f<=0){i();return}const h=setTimeout(()=>{i()},f);return()=>clearTimeout(h)},[e,o,i]),null}function L({children:e}){const o=p(),r=d(u,n=>n.isAuthenticated);return o.pathname==="/login"?e:r?a.jsxs(j,{children:[e,a.jsx(A,{})]}):a.jsx(v,{to:"/login",replace:!0})}export{L as default};
