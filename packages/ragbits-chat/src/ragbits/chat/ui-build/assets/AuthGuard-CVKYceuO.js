import{r as l,j as t,aW as n,bo as x,bp as f,bq as b,br as d,bs as h,bt as j}from"./index-CeRB0wLo.js";import{a}from"./authStore-vR480IpG.js";import{u as m}from"./useInitializeUserStore-BMX2hXw0.js";const p=l.createContext(null);function S({children:s}){const[r]=l.useState(()=>a);return t.jsx(p.Provider,{value:r,children:s})}function g(){const{logout:s,login:r,setHydrated:i}=n(a,e=>e),{client:c}=x(),u=m();return l.useEffect(()=>{(async()=>{try{const o=await c.makeRequest("/api/user");o?(r(o),u(o.user_id)):s()}catch(o){console.error("Failed to check session:",o),s()}finally{i()}})()},[]),null}function v({children:s}){const r=f(),i=n(a,e=>e.isAuthenticated),c=n(a,e=>e.hasHydrated),u=n(a,e=>e.logout);return c?r.pathname==="/login"?t.jsx(d,{baseUrl:h,auth:{credentials:"include"},children:s}):i?t.jsx(S,{children:t.jsx(d,{baseUrl:h,auth:{onUnauthorized:u,credentials:"include"},children:s})}):t.jsx(j,{to:"/login",replace:!0}):t.jsxs(t.Fragment,{children:[t.jsx(g,{}),t.jsx(b,{})]})}export{v as default};
