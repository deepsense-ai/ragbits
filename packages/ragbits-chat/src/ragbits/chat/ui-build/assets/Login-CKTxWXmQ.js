import{r as o,a4 as w,ai as y,E as e,H as S,a7 as b,a2 as j}from"./useThemeContext-DkrqKvLn.js";import{H as v,c as C,m as P}from"./main-BJLJjzL4.js";import{a as E}from"./authStore-BZmq_GrX.js";import{i as c}from"./chunk-SSA7SXE4-BswVq7lY.js";const N=()=>{const a=o.useContext(v);if(!a)throw new Error("useInitializeUserStore must be used within a HistoryStoreContextProvider");return a.initializeUserStore};function _(){const[a,m]=o.useState({username:"",password:""}),u=C("/api/auth/login",{headers:{"Content-Type":"application/json"},method:"POST"}),p=w(E,s=>s.login),g=y(),x=N(),[f,n]=o.useState(!1),h=async s=>{n(!1),s.preventDefault(),s.stopPropagation();const r=new FormData(s.currentTarget),i=r.get("username"),l=r.get("password");try{const t=await u.call({body:{username:i,password:l}});if(!t.success||!t.jwt_token||!t.user){n(!0);return}p(t.user,t.jwt_token),x(t.user.user_id),g("/")}catch(t){n(!0),console.error("Failed to login",t)}},d=s=>r=>m(i=>j(i,l=>{l[s]=r.target.value}));return o.useEffect(()=>{document.title="Login"},[]),e.jsx("div",{className:"flex h-screen w-screen",children:e.jsxs("form",{className:"rounded-medium border-small border-divider m-auto flex w-full max-w-xs flex-col gap-4 p-4",onSubmit:h,children:[e.jsxs("div",{className:"text-small",children:[e.jsx("div",{className:"text-foreground truncate leading-5 font-semibold",children:"Sign in"}),e.jsx("div",{className:"text-default-500 truncate leading-5 font-normal",children:"Sign in to start chatting."})]}),e.jsx(c,{label:"Username",name:"username",labelPlacement:"outside",placeholder:"Your username",required:!0,isRequired:!0,value:a.username,onChange:d("username")}),e.jsx(c,{label:"Password",labelPlacement:"outside",id:"password",name:"password",type:"password",placeholder:"••••••••",required:!0,isRequired:!0,value:a.password,onChange:d("password")}),e.jsx(S,{children:f&&!u.isLoading&&e.jsx(P.div,{className:"text-small text-danger",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3,ease:"easeOut"},children:"We couldn't sign you in. Please verify your credentials and try again."})}),e.jsx(b,{type:"submit",color:a.password&&a.username?"primary":"default",children:"Sign in"})]})})}export{_ as default};
