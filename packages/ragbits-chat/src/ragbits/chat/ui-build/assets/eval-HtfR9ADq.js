import{l as os,d as ls,e as Ve,f as Te,ay as ae,az as is,F as ce,s as de,y as q,E as e,q as Be,U as Ge,aA as cs,r as f,aB as ds,D as Je,w as qe,v as Pe,x as Ye,z as ie,A as H,B as Ne,aC as us,n as ms,aD as xs,k as hs,m as $e,aE as Xe,$ as fs,aF as ps,aG as gs,aH as bs,V as js,aI as _s,L as vs,G as ks,Y as Ns,K as ys,N as Ss,a5 as ws,a3 as Cs,a4 as Rs,aJ as Ts,ai as ue,a8 as y,ak as Ps,al as Ce,a7 as W,ap as $s,ae as M,a0 as Y,aK as V,ah as Qe,ad as ee,a9 as Ds,aa as Is,ab as Fs,af as Ls,ac as Le,J as Ms,aL as As,aq as Ks,ar as Es,as as Os,at as Ws,au as zs,aw as Hs,aM as Us}from"./useThemeContext-DkrqKvLn.js";import{$ as Vs,t as Bs,a as Gs,b as re,c as Js,d as qs,e as oe}from"./chunk-F3UDT23P-C4MzBAmg.js";import{$ as Ys}from"./useSelectableItem-BR0VPP-3.js";import{d as Xs}from"./features-animation-Dc-yT_Yb.js";import{$ as Qs,l as Zs,a as Ze,s as et}from"./chunk-Y2AYO5NJ-Crd-u0HB.js";import{d as st,a as tt,b as nt,m as Me}from"./chunk-XHRYXXZA-eia5gCmD.js";import{i as le}from"./chunk-SSA7SXE4-BswVq7lY.js";import{m as at}from"./chunk-IGSAU2ZA-CRWCDn7K.js";import"./index-B9NaYZAN.js";import"./useMenuTriggerState-DfYBgrZh.js";const rt={...Xs,...ls,...os};var Ae=Ve({slots:{base:"inline-flex",tabList:["flex","p-1","h-fit","gap-2","items-center","flex-nowrap","overflow-x-scroll","scrollbar-hide","bg-default-100"],tab:["z-0","w-full","px-3","py-1","flex","group","relative","justify-center","items-center","outline-hidden","cursor-pointer","transition-opacity","tap-highlight-transparent","data-[disabled=true]:cursor-not-allowed","data-[disabled=true]:opacity-30","data-[hover-unselected=true]:opacity-disabled",...Te],tabContent:["relative","z-10","text-inherit","whitespace-nowrap","transition-colors","text-default-500","group-data-[selected=true]:text-foreground"],cursor:["absolute","z-0","bg-white"],panel:["py-3","px-1","outline-hidden","data-[inert=true]:hidden",...Te],tabWrapper:[]},variants:{variant:{solid:{cursor:"inset-0"},light:{tabList:"bg-transparent dark:bg-transparent",cursor:"inset-0"},underlined:{tabList:"bg-transparent dark:bg-transparent",cursor:"h-[2px] w-[80%] bottom-0 shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]"},bordered:{tabList:"bg-transparent dark:bg-transparent border-medium border-default-200 shadow-xs",cursor:"inset-0"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{tabList:"rounded-medium",tab:"h-7 text-tiny rounded-small",cursor:"rounded-small"},md:{tabList:"rounded-medium",tab:"h-8 text-small rounded-small",cursor:"rounded-small"},lg:{tabList:"rounded-large",tab:"h-9 text-medium rounded-medium",cursor:"rounded-medium"}},radius:{none:{tabList:"rounded-none",tab:"rounded-none",cursor:"rounded-none"},sm:{tabList:"rounded-medium",tab:"rounded-small",cursor:"rounded-small"},md:{tabList:"rounded-medium",tab:"rounded-small",cursor:"rounded-small"},lg:{tabList:"rounded-large",tab:"rounded-medium",cursor:"rounded-medium"},full:{tabList:"rounded-full",tab:"rounded-full",cursor:"rounded-full"}},fullWidth:{true:{base:"w-full",tabList:"w-full"}},isDisabled:{true:{tabList:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{tab:"transition-none",tabContent:"transition-none"}},placement:{top:{},start:{tabList:"flex-col",panel:"py-0 px-3",tabWrapper:"flex"},end:{tabList:"flex-col",panel:"py-0 px-3",tabWrapper:"flex flex-row-reverse"},bottom:{tabWrapper:"flex flex-col-reverse"}}},defaultVariants:{color:"default",variant:"solid",size:"md",fullWidth:!1,isDisabled:!1},compoundVariants:[{variant:["solid","bordered","light"],color:"default",class:{cursor:["bg-background","dark:bg-default","shadow-small"],tabContent:"group-data-[selected=true]:text-default-foreground"}},{variant:["solid","bordered","light"],color:"primary",class:{cursor:ae.solid.primary,tabContent:"group-data-[selected=true]:text-primary-foreground"}},{variant:["solid","bordered","light"],color:"secondary",class:{cursor:ae.solid.secondary,tabContent:"group-data-[selected=true]:text-secondary-foreground"}},{variant:["solid","bordered","light"],color:"success",class:{cursor:ae.solid.success,tabContent:"group-data-[selected=true]:text-success-foreground"}},{variant:["solid","bordered","light"],color:"warning",class:{cursor:ae.solid.warning,tabContent:"group-data-[selected=true]:text-warning-foreground"}},{variant:["solid","bordered","light"],color:"danger",class:{cursor:ae.solid.danger,tabContent:"group-data-[selected=true]:text-danger-foreground"}},{variant:"underlined",color:"default",class:{cursor:"bg-foreground",tabContent:"group-data-[selected=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{cursor:"bg-primary",tabContent:"group-data-[selected=true]:text-primary"}},{variant:"underlined",color:"secondary",class:{cursor:"bg-secondary",tabContent:"group-data-[selected=true]:text-secondary"}},{variant:"underlined",color:"success",class:{cursor:"bg-success",tabContent:"group-data-[selected=true]:text-success"}},{variant:"underlined",color:"warning",class:{cursor:"bg-warning",tabContent:"group-data-[selected=true]:text-warning"}},{variant:"underlined",color:"danger",class:{cursor:"bg-danger",tabContent:"group-data-[selected=true]:text-danger"}},{disableAnimation:!0,variant:"underlined",class:{tab:["after:content-['']","after:absolute","after:bottom-0","after:h-[2px]","after:w-[80%]","after:opacity-0","after:shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","data-[selected=true]:after:opacity-100"]}},{disableAnimation:!0,color:"default",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-default data-[selected=true]:text-default-foreground"}},{disableAnimation:!0,color:"primary",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-primary data-[selected=true]:text-primary-foreground"}},{disableAnimation:!0,color:"secondary",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-secondary data-[selected=true]:text-secondary-foreground"}},{disableAnimation:!0,color:"success",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-success data-[selected=true]:text-success-foreground"}},{disableAnimation:!0,color:"warning",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-warning data-[selected=true]:text-warning-foreground"}},{disableAnimation:!0,color:"danger",variant:["solid","bordered","light"],class:{tab:"data-[selected=true]:bg-danger data-[selected=true]:text-danger-foreground"}},{disableAnimation:!0,color:"default",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-foreground"}},{disableAnimation:!0,color:"primary",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-primary"}},{disableAnimation:!0,color:"secondary",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-secondary"}},{disableAnimation:!0,color:"success",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-success"}},{disableAnimation:!0,color:"warning",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-warning"}},{disableAnimation:!0,color:"danger",variant:"underlined",class:{tab:"data-[selected=true]:after:bg-danger"}}],compoundSlots:[{variant:"underlined",slots:["tab","tabList","cursor"],class:["rounded-none"]}]}),Ke=Ve({slots:{base:["flex","flex-col","relative","overflow-hidden","h-auto","outline-hidden","text-foreground","box-border","bg-content1",...Te],header:["flex","p-3","z-10","w-full","justify-start","items-center","shrink-0","overflow-inherit","color-inherit","subpixel-antialiased"],body:["relative","flex","flex-1","w-full","p-3","flex-auto","flex-col","place-content-inherit","align-items-inherit","h-auto","break-words","text-left","overflow-y-auto","subpixel-antialiased"],footer:["p-3","h-auto","flex","w-full","items-center","overflow-hidden","color-inherit","subpixel-antialiased"]},variants:{shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},radius:{none:{base:"rounded-none",header:"rounded-none",footer:"rounded-none"},sm:{base:"rounded-small",header:"rounded-t-small",footer:"rounded-b-small"},md:{base:"rounded-medium",header:"rounded-t-medium",footer:"rounded-b-medium"},lg:{base:"rounded-large",header:"rounded-t-large",footer:"rounded-b-large"}},fullWidth:{true:{base:"w-full"}},isHoverable:{true:{base:"data-[hover=true]:bg-content2 dark:data-[hover=true]:bg-content2"}},isPressable:{true:{base:"cursor-pointer"}},isBlurred:{true:{base:["bg-background/80","dark:bg-background/20","backdrop-blur-md","backdrop-saturate-150"]}},isFooterBlurred:{true:{footer:["bg-background/10","backdrop-blur","backdrop-saturate-150"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:"",false:{base:"transition-transform-background motion-reduce:transition-none"}}},compoundVariants:[{isPressable:!0,class:"data-[pressed=true]:scale-[0.97] tap-highlight-transparent"}],defaultVariants:{radius:"lg",shadow:"md",fullWidth:!1,isHoverable:!1,isPressable:!1,isDisabled:!1,isFooterBlurred:!1}}),[ot,lt]=is({name:"CardContext",strict:!0,errorMessage:"useCardContext: `context` is undefined. Seems you forgot to wrap component within <Card />"}),es=ce((t,a)=>{var s;const{as:n,className:r,children:o,...i}=t,l=n||"div",m=de(a),{slots:p,classNames:b}=lt(),g=q(b?.body,r);return e.jsx(l,{ref:m,className:(s=p.body)==null?void 0:s.call(p,{class:g}),...i,children:o})});es.displayName="HeroUI.CardBody";var F=es;function it(t){var a,s,n,r;const o=Be(),[i,l]=Ge(t,Ke.variantKeys),{ref:m,as:p,children:b,onClick:g,onPress:u,autoFocus:j,className:c,classNames:x,allowTextSelectionOnPress:h=!0,...v}=i,d=de(m),N=p||(t.isPressable?"button":"div"),_=typeof N=="string",w=(s=(a=t.disableAnimation)!=null?a:o?.disableAnimation)!=null?s:!1,R=(r=(n=t.disableRipple)!=null?n:o?.disableRipple)!=null?r:!1,$=q(x?.base,c),{onClear:I,onPress:S,ripples:k}=cs(),E=f.useCallback(B=>{R||w||d.current&&S(B)},[R,w,d,S]),{buttonProps:D,isPressed:T}=ds({onPress:Je(u,E),elementType:p,isDisabled:!t.isPressable,onClick:g,allowTextSelectionOnPress:h,...v},d),{hoverProps:C,isHovered:A}=qe({isDisabled:!t.isHoverable,...v}),{isFocusVisible:O,isFocused:P,focusProps:z}=Pe({autoFocus:j}),U=f.useMemo(()=>Ke({...l,disableAnimation:w}),[Ye(l),w]),Q=f.useMemo(()=>({slots:U,classNames:x,disableAnimation:w,isDisabled:t.isDisabled,isFooterBlurred:t.isFooterBlurred,fullWidth:t.fullWidth}),[U,x,t.isDisabled,t.isFooterBlurred,w,t.fullWidth]),te=f.useCallback((B={})=>({ref:d,className:U.base({class:$}),tabIndex:t.isPressable?0:-1,"data-hover":H(A),"data-pressed":H(T),"data-focus":H(P),"data-focus-visible":H(O),"data-disabled":H(t.isDisabled),...ie(t.isPressable?{...D,...z,role:"button"}:{},t.isHoverable?C:{},Ne(v,{enabled:_}),Ne(B))}),[d,U,$,_,t.isPressable,t.isHoverable,t.isDisabled,A,T,O,D,z,C,v]),ne=f.useCallback(()=>({ripples:k,onClear:I}),[k,I]);return{context:Q,domRef:d,Component:N,classNames:x,children:b,isHovered:A,isPressed:T,disableAnimation:w,isPressable:t.isPressable,isHoverable:t.isHoverable,disableRipple:R,handlePress:E,isFocusVisible:O,getCardProps:te,getRippleProps:ne}}var ss=ce((t,a)=>{const{children:s,context:n,Component:r,isPressable:o,disableAnimation:i,disableRipple:l,getCardProps:m,getRippleProps:p}=it({...t,ref:a});return e.jsxs(r,{...m(),children:[e.jsx(ot,{value:n,children:s}),o&&!i&&!l&&e.jsx(us,{...p()})]})});ss.displayName="HeroUI.Card";var L=ss;const Ee=t=>typeof t=="object"&&t!=null&&t.nodeType===1,Oe=(t,a)=>(!a||t!=="hidden")&&t!=="visible"&&t!=="clip",je=(t,a)=>{if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){const s=getComputedStyle(t,null);return Oe(s.overflowY,a)||Oe(s.overflowX,a)||(n=>{const r=(o=>{if(!o.ownerDocument||!o.ownerDocument.defaultView)return null;try{return o.ownerDocument.defaultView.frameElement}catch{return null}})(n);return!!r&&(r.clientHeight<n.scrollHeight||r.clientWidth<n.scrollWidth)})(t)}return!1},_e=(t,a,s,n,r,o,i,l)=>o<t&&i>a||o>t&&i<a?0:o<=t&&l<=s||i>=a&&l>=s?o-t-n:i>a&&l<s||o<t&&l>s?i-a+r:0,ct=t=>{const a=t.parentElement;return a??(t.getRootNode().host||null)},We=(t,a)=>{var s,n,r,o;if(typeof document>"u")return[];const{scrollMode:i,block:l,inline:m,boundary:p,skipOverflowHiddenElements:b}=a,g=typeof p=="function"?p:O=>O!==p;if(!Ee(t))throw new TypeError("Invalid target");const u=document.scrollingElement||document.documentElement,j=[];let c=t;for(;Ee(c)&&g(c);){if(c=ct(c),c===u){j.push(c);break}c!=null&&c===document.body&&je(c)&&!je(document.documentElement)||c!=null&&je(c,b)&&j.push(c)}const x=(n=(s=window.visualViewport)==null?void 0:s.width)!=null?n:innerWidth,h=(o=(r=window.visualViewport)==null?void 0:r.height)!=null?o:innerHeight,{scrollX:v,scrollY:d}=window,{height:N,width:_,top:w,right:R,bottom:$,left:I}=t.getBoundingClientRect(),{top:S,right:k,bottom:E,left:D}=(O=>{const P=window.getComputedStyle(O);return{top:parseFloat(P.scrollMarginTop)||0,right:parseFloat(P.scrollMarginRight)||0,bottom:parseFloat(P.scrollMarginBottom)||0,left:parseFloat(P.scrollMarginLeft)||0}})(t);let T=l==="start"||l==="nearest"?w-S:l==="end"?$+E:w+N/2-S+E,C=m==="center"?I+_/2-D+k:m==="end"?R+k:I-D;const A=[];for(let O=0;O<j.length;O++){const P=j[O],{height:z,width:U,top:Q,right:te,bottom:ne,left:B}=P.getBoundingClientRect();if(i==="if-needed"&&w>=0&&I>=0&&$<=h&&R<=x&&(P===u&&!je(P)||w>=Q&&$<=ne&&I>=B&&R<=te))return A;const me=getComputedStyle(P),xe=parseInt(me.borderLeftWidth,10),he=parseInt(me.borderTopWidth,10),fe=parseInt(me.borderRightWidth,10),pe=parseInt(me.borderBottomWidth,10);let G=0,J=0;const ge="offsetWidth"in P?P.offsetWidth-P.clientWidth-xe-fe:0,be="offsetHeight"in P?P.offsetHeight-P.clientHeight-he-pe:0,Se="offsetWidth"in P?P.offsetWidth===0?0:U/P.offsetWidth:0,we="offsetHeight"in P?P.offsetHeight===0?0:z/P.offsetHeight:0;if(u===P)G=l==="start"?T:l==="end"?T-h:l==="nearest"?_e(d,d+h,h,he,pe,d+T,d+T+N,N):T-h/2,J=m==="start"?C:m==="center"?C-x/2:m==="end"?C-x:_e(v,v+x,x,xe,fe,v+C,v+C+_,_),G=Math.max(0,G+d),J=Math.max(0,J+v);else{G=l==="start"?T-Q-he:l==="end"?T-ne+pe+be:l==="nearest"?_e(Q,ne,z,he,pe+be,T,T+N,N):T-(Q+z/2)+be/2,J=m==="start"?C-B-xe:m==="center"?C-(B+U/2)+ge/2:m==="end"?C-te+fe+ge:_e(B,te,U,xe,fe+ge,C,C+_,_);const{scrollLeft:Ie,scrollTop:Fe}=P;G=we===0?0:Math.max(0,Math.min(Fe+G/we,P.scrollHeight-z/we+be)),J=Se===0?0:Math.max(0,Math.min(Ie+J/Se,P.scrollWidth-U/Se+ge)),T+=Fe-G,C+=Ie-J}A.push({el:P,top:G,left:J})}return A},dt=t=>t===!1?{block:"end",inline:"nearest"}:(a=>a===Object(a)&&Object.keys(a).length!==0)(t)?t:{block:"start",inline:"nearest"};function ut(t,a){if(!t.isConnected||!(n=>{let r=n;for(;r&&r.parentNode;){if(r.parentNode===document)return!0;r=r.parentNode instanceof ShadowRoot?r.parentNode.host:r.parentNode}return!1})(t))return;if((n=>typeof n=="object"&&typeof n.behavior=="function")(a))return a.behavior(We(t,a));const s=typeof a=="boolean"||a==null?void 0:a.behavior;for(const{el:n,top:r,left:o}of We(t,dt(a)))n.scroll({top:r,left:o,behavior:s})}const ts=new WeakMap;function ye(t,a,s){return t?(typeof a=="string"&&(a=a.replace(/\s+/g,"")),`${ts.get(t)}-${s}-${a}`):""}function mt(t,a,s){let{key:n,isDisabled:r,shouldSelectOnPressUp:o}=t,{selectionManager:i,selectedKey:l}=a,m=n===l,p=r||a.isDisabled||a.selectionManager.isDisabled(n),{itemProps:b,isPressed:g}=Ys({selectionManager:i,key:n,ref:s,isDisabled:p,shouldSelectOnPressUp:o,linkBehavior:"selection"}),u=ye(a,n,"tab"),j=ye(a,n,"tabpanel"),{tabIndex:c}=b,x=a.collection.getItem(n),h=ms(x?.props,{labelable:!0});delete h.id;let v=xs(x?.props),{focusableProps:d}=hs({isDisabled:p},s);return{tabProps:$e(h,d,v,b,{id:u,"aria-selected":m,"aria-disabled":p||void 0,"aria-controls":m?j:void 0,tabIndex:p?void 0:c,role:"tab"}),isSelected:m,isDisabled:p,isPressed:g}}function xt(t,a,s){let n=Vs(s)?void 0:0;var r;const o=ye(a,(r=t.id)!==null&&r!==void 0?r:a?.selectedKey,"tabpanel"),i=Xe({...t,id:o,"aria-labelledby":ye(a,a?.selectedKey,"tab")});return{tabPanelProps:$e(i,{tabIndex:n,role:"tabpanel","aria-describedby":t["aria-describedby"],"aria-details":t["aria-details"]})}}class ht{getKeyLeftOf(a){return this.flipDirection?this.getNextKey(a):this.getPreviousKey(a)}getKeyRightOf(a){return this.flipDirection?this.getPreviousKey(a):this.getNextKey(a)}isDisabled(a){var s,n;return this.disabledKeys.has(a)||!!(!((n=this.collection.getItem(a))===null||n===void 0||(s=n.props)===null||s===void 0)&&s.isDisabled)}getFirstKey(){let a=this.collection.getFirstKey();return a!=null&&this.isDisabled(a)&&(a=this.getNextKey(a)),a}getLastKey(){let a=this.collection.getLastKey();return a!=null&&this.isDisabled(a)&&(a=this.getPreviousKey(a)),a}getKeyAbove(a){return this.tabDirection?null:this.getPreviousKey(a)}getKeyBelow(a){return this.tabDirection?null:this.getNextKey(a)}getNextKey(a){let s=a;do s=this.collection.getKeyAfter(s),s==null&&(s=this.collection.getFirstKey());while(s!=null&&this.isDisabled(s));return s}getPreviousKey(a){let s=a;do s=this.collection.getKeyBefore(s),s==null&&(s=this.collection.getLastKey());while(s!=null&&this.isDisabled(s));return s}constructor(a,s,n,r=new Set){this.collection=a,this.flipDirection=s==="rtl"&&n==="horizontal",this.disabledKeys=r,this.tabDirection=n==="horizontal"}}function ft(t,a,s){let{orientation:n="horizontal",keyboardActivation:r="automatic"}=t,{collection:o,selectionManager:i,disabledKeys:l}=a,{direction:m}=fs(),p=f.useMemo(()=>new ht(o,m,n,l),[o,l,n,m]),{collectionProps:b}=ps({ref:s,selectionManager:i,keyboardDelegate:p,selectOnFocus:r==="automatic",disallowEmptySelection:!0,scrollRef:s,linkBehavior:"selection"}),g=gs();ts.set(a,g);let u=Xe({...t,id:g});return{tabListProps:{...$e(b,u),role:"tablist","aria-orientation":n,tabIndex:void 0}}}var ns=ce((t,a)=>{var s,n;const{as:r,tabKey:o,destroyInactiveTabPanel:i,state:l,className:m,slots:p,classNames:b,...g}=t,u=r||"div",j=de(a),{tabPanelProps:c}=xt({...t,id:String(o)},l,j),{focusProps:x,isFocused:h,isFocusVisible:v}=Pe(),d=l.selectedItem,N=l.collection.getItem(o).props.children,_=q(b?.panel,m,(s=d?.props)==null?void 0:s.className),w=o===d?.key;return!N||!w&&i?null:e.jsx(u,{ref:j,"data-focus":h,"data-focus-visible":v,"data-inert":w?void 0:"true",inert:bs(!w),...w&&ie(c,x,g),className:(n=p.panel)==null?void 0:n.call(p,{class:_}),"data-slot":"panel",children:N})});ns.displayName="HeroUI.TabPanel";var pt=ns,as=ce((t,a)=>{var s;const{className:n,as:r,item:o,state:i,classNames:l,isDisabled:m,listRef:p,slots:b,motionProps:g,disableAnimation:u,disableCursorAnimation:j,shouldSelectOnPressUp:c,onClick:x,tabRef:h,...v}=t,{key:d}=o,N=de(a),_=r||(t.href?"a":"button"),w=typeof _=="string",{tabProps:R,isSelected:$,isDisabled:I,isPressed:S}=mt({key:d,isDisabled:m,shouldSelectOnPressUp:c},i,N);t.children==null&&delete R["aria-controls"];const k=m||I,{focusProps:E,isFocused:D,isFocusVisible:T}=Pe(),{hoverProps:C,isHovered:A}=qe({isDisabled:k}),O=q(l?.tab,n),[,P]=js({rerender:!0}),z=()=>{!N?.current||!p?.current||ut(N.current,{scrollMode:"if-needed",behavior:"smooth",block:"end",inline:"end",boundary:p?.current})};return e.jsxs(_,{ref:_s(N,h),"data-disabled":H(I),"data-focus":H(D),"data-focus-visible":H(T),"data-hover":H(A),"data-hover-unselected":H((A||S)&&!$),"data-pressed":H(S),"data-selected":H($),"data-slot":"tab",...ie(R,k?{}:{...E,...C},Ne(v,{enabled:w,omitPropNames:new Set(["title"])}),{onClick:Je(z,x,R.onClick)}),className:(s=b.tab)==null?void 0:s.call(b,{class:O}),title:v?.titleValue,type:_==="button"?"button":void 0,children:[$&&!u&&!j&&P?e.jsx(vs,{features:rt,children:e.jsx(ks.span,{className:b.cursor({class:l?.cursor}),"data-slot":"cursor",layoutDependency:!1,layoutId:"cursor",transition:{type:"spring",bounce:.15,duration:.5},...g})}):null,e.jsx("div",{className:b.tabContent({class:l?.tabContent}),"data-slot":"tabContent",children:o.rendered})]})});as.displayName="HeroUI.Tab";var gt=as;function bt(t){var a;let[s,n]=Ns(t.selectedKey,(a=t.defaultSelectedKey)!==null&&a!==void 0?a:null,t.onSelectionChange),r=f.useMemo(()=>s!=null?[s]:[],[s]),{collection:o,disabledKeys:i,selectionManager:l}=Qs({...t,selectionMode:"single",disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:r,onSelectionChange:p=>{if(p==="all")return;var b;let g=(b=p.values().next().value)!==null&&b!==void 0?b:null;g===s&&t.onSelectionChange&&t.onSelectionChange(g),n(g)}}),m=s!=null?o.getItem(s):null;return{collection:o,disabledKeys:i,selectionManager:l,selectedKey:s,setSelectedKey:n,selectedItem:m}}function jt(t){var a,s;let n=bt({...t,onSelectionChange:t.onSelectionChange?m=>{var p;m!=null&&((p=t.onSelectionChange)===null||p===void 0||p.call(t,m))}:void 0,suppressTextValueWarning:!0,defaultSelectedKey:(s=(a=t.defaultSelectedKey)!==null&&a!==void 0?a:ze(t.collection,t.disabledKeys?new Set(t.disabledKeys):new Set))!==null&&s!==void 0?s:void 0}),{selectionManager:r,collection:o,selectedKey:i}=n,l=f.useRef(i);return f.useEffect(()=>{let m=i;t.selectedKey==null&&(r.isEmpty||m==null||!o.getItem(m))&&(m=ze(o,n.disabledKeys),m!=null&&r.setSelectedKeys([m])),(m!=null&&r.focusedKey==null||!r.isFocused&&m!==l.current)&&r.setFocusedKey(m),l.current=m}),{...n,isDisabled:t.isDisabled||!1}}function ze(t,a){let s=null;if(t){var n,r,o,i;for(s=t.getFirstKey();s!=null&&(a.has(s)||!((r=t.getItem(s))===null||r===void 0||(n=r.props)===null||n===void 0)&&n.isDisabled)&&s!==t.getLastKey();)s=t.getKeyAfter(s);s!=null&&(a.has(s)||!((i=t.getItem(s))===null||i===void 0||(o=i.props)===null||o===void 0)&&o.isDisabled)&&s===t.getLastKey()&&(s=t.getFirstKey())}return s}function _t(t){var a,s,n;const r=Be(),[o,i]=Ge(t,Ae.variantKeys),{ref:l,as:m,className:p,classNames:b,children:g,disableCursorAnimation:u,motionProps:j,isVertical:c=!1,shouldSelectOnPressUp:x=!0,destroyInactiveTabPanel:h=!0,...v}=o,d=m||"div",N=typeof d=="string",_=de(l),w=(s=(a=t?.disableAnimation)!=null?a:r?.disableAnimation)!=null?s:!1,R=jt({children:g,...v}),{tabListProps:$}=ft(v,R,_),I=f.useMemo(()=>Ae({...i,disableAnimation:w,...c?{placement:"start"}:{}}),[Ye(i),w,c]),S=q(b?.base,p),k=f.useMemo(()=>({state:R,slots:I,classNames:b,motionProps:j,disableAnimation:w,listRef:_,shouldSelectOnPressUp:x,disableCursorAnimation:u,isDisabled:t?.isDisabled}),[R,I,_,j,w,u,x,t?.isDisabled,b]),E=f.useCallback(A=>({"data-slot":"base",className:I.base({class:q(S,A?.className)}),...ie(Ne(v,{enabled:N}),A)}),[S,v,I]),D=(n=i.placement)!=null?n:c?"start":"top",T=f.useCallback(A=>({"data-slot":"tabWrapper",className:I.tabWrapper({class:q(b?.tabWrapper,A?.className)}),"data-placement":D,"data-vertical":c||D==="start"||D==="end"?"vertical":"horizontal"}),[b,I,D,c]),C=f.useCallback(A=>({ref:_,"data-slot":"tabList",className:I.tabList({class:q(b?.tabList,A?.className)}),...ie($,A)}),[_,$,b,I]);return{Component:d,domRef:_,state:R,values:k,destroyInactiveTabPanel:h,getBaseProps:E,getTabListProps:C,getWrapperProps:T}}var vt=ce(function(a,s){const{Component:n,values:r,state:o,destroyInactiveTabPanel:i,getBaseProps:l,getTabListProps:m,getWrapperProps:p}=_t({...a,ref:s}),b=f.useId(),g=!a.disableAnimation&&!a.disableCursorAnimation,u={state:o,listRef:r.listRef,slots:r.slots,classNames:r.classNames,isDisabled:r.isDisabled,motionProps:r.motionProps,disableAnimation:r.disableAnimation,shouldSelectOnPressUp:r.shouldSelectOnPressUp,disableCursorAnimation:r.disableCursorAnimation},j=[...o.collection].map(x=>e.jsx(gt,{item:x,...u,...x.props},x.key)),c=e.jsxs(e.Fragment,{children:[e.jsx("div",{...l(),children:e.jsx(n,{...m(),children:g?e.jsx(ys,{id:b,children:j}):j})}),[...o.collection].map(x=>e.jsx(pt,{classNames:r.classNames,destroyInactiveTabPanel:i,slots:r.slots,state:r.state,tabKey:x.key},x.key))]});return"placement"in a||"isVertical"in a?e.jsx("div",{...p(),children:c}):c}),rs=vt,kt=Ss,ke=kt;const se=t=>t===0,Re={max_turns_scenario:15,max_turns_task:4,sim_user_model_name:null,checker_model_name:null,default_model:"gpt-4o-mini",persona:null},Nt=()=>ws()(Cs((t,a)=>({config:null,isConfigLoading:!1,configError:null,scenarios:{},selectedScenarioName:null,selectedForRun:[],selectedPersonas:[],executions:{},currentRunId:null,isExecuting:!1,simulationConfig:Re,simulationRuns:[],isSimulationRunsLoading:!1,viewMode:"summary",evalView:"scenarios",runHistory:{},selectedRunId:null,actions:{setConfig:s=>{t(n=>{n.config=s,n.isConfigLoading=!1,n.configError=null})},setConfigLoading:s=>{t(n=>{n.isConfigLoading=s})},setConfigError:s=>{t(n=>{n.configError=s,n.isConfigLoading=!1})},setScenario:(s,n)=>{t(r=>{r.scenarios[s]=n})},selectScenario:s=>{t(n=>{n.selectedScenarioName=s})},updateScenarioTask:(s,n,r)=>{t(o=>{const i=o.scenarios[s];i&&i.tasks[n]&&Object.assign(i.tasks[n],r)})},toggleScenarioForRun:s=>{t(n=>{const r=n.selectedForRun.indexOf(s);r===-1?n.selectedForRun.push(s):n.selectedForRun.splice(r,1)})},selectAllScenariosForRun:()=>{t(s=>{s.config&&(s.selectedForRun=s.config.available_scenarios.filter(n=>!se(n.num_tasks)).map(n=>n.name))})},clearScenariosForRun:()=>{t(s=>{s.selectedForRun=[]})},selectScenariosForRun:s=>{t(n=>{for(const r of s)n.selectedForRun.includes(r)||n.selectedForRun.push(r)})},deselectScenariosForRun:s=>{t(n=>{n.selectedForRun=n.selectedForRun.filter(r=>!s.includes(r))})},togglePersonaForRun:s=>{t(n=>{const r=n.selectedPersonas.indexOf(s);r>=0?n.selectedPersonas.splice(r,1):n.selectedPersonas.push(s)})},selectPersonasForRun:s=>{t(n=>{for(const r of s)n.selectedPersonas.includes(r)||n.selectedPersonas.push(r)})},clearPersonasForRun:()=>{t(s=>{s.selectedPersonas=[]})},startExecution:(s,n)=>{t(r=>{r.currentRunId=s,r.isExecuting=!0;for(const o of n)r.executions[o]={scenarioName:o,status:"queued",startTime:Date.now(),currentTurn:0,currentTaskIndex:0,currentTask:null,turns:[],responseChunks:[],error:null}})},handleProgressUpdate:s=>{t(n=>{const r=n.executions[s.scenario_name];if(r)switch(s.type){case"status":r.status=s.status,r.currentTurn=s.current_turn??0,r.currentTaskIndex=s.current_task_index??0,r.currentTask=s.current_task??null;break;case"turn":{const l={turn_index:s.turn_index,task_index:s.task_index,user_message:s.user_message,assistant_message:s.assistant_message,tool_calls:s.tool_calls,task_completed:s.task_completed,task_completed_reason:s.task_completed_reason,checkers:s.checkers,checker_mode:s.checker_mode};r.turns.push(l),r.currentTurn=s.turn_index,r.currentTaskIndex=s.task_index;break}case"task_complete":break;case"complete":r.status=s.status,Object.values(n.executions).every(l=>l.status==="completed"||l.status==="failed"||l.status==="timeout")&&(n.isExecuting=!1);break;case"error":r.status="failed",r.error=s.error,Object.values(n.executions).every(l=>l.status==="completed"||l.status==="failed"||l.status==="timeout")&&(n.isExecuting=!1);break;case"response_chunk":{const l={turn_index:s.turn_index,task_index:s.task_index,chunk_index:r.responseChunks.length,chunk_type:s.chunk_type,chunk_data:s.chunk_data,timestamp:Date.now()};r.responseChunks.push(l);break}}})},stopExecution:()=>{t(s=>{s.isExecuting=!1;for(const n of Object.values(s.executions))(n.status==="running"||n.status==="queued")&&(n.status="failed",n.error="Stopped by user")})},clearExecutions:()=>{t(s=>{s.executions={},s.currentRunId=null,s.isExecuting=!1})},setSimulationConfig:s=>{t(n=>{Object.assign(n.simulationConfig,s)})},setSimulationRuns:s=>{t(n=>{n.simulationRuns=s,n.isSimulationRunsLoading=!1})},setSimulationRunsLoading:s=>{t(n=>{n.isSimulationRunsLoading=s})},addSimulationRun:s=>{t(n=>{n.simulationRuns.unshift(s)})},updateSimulationRun:(s,n)=>{t(r=>{const o=r.simulationRuns.findIndex(i=>i.id===s);o!==-1&&Object.assign(r.simulationRuns[o],n)})},updateScenarioRunInSimulation:(s,n,r)=>{t(o=>{const i=o.simulationRuns.find(m=>m.id===s);if(!i)return;const l=i.scenarioRuns.find(m=>m.id===n);l&&Object.assign(l,r)})},addResponseChunkToScenarioRun:(s,n,r)=>{t(o=>{const i=o.simulationRuns.find(m=>m.id===s);if(!i)return;const l=i.scenarioRuns.find(m=>m.id===n);l&&(l.responseChunks||(l.responseChunks=[]),l.responseChunks.push(r))})},setViewMode:s=>{t(n=>{n.viewMode=s})},setEvalView:s=>{t(n=>{n.evalView=s})},navigateToScenarioDetail:s=>{t(n=>{n.selectedScenarioName=s,n.evalView="scenario-detail"})},navigateToRunner:s=>{t(n=>{n.selectedScenarioName=s,n.evalView="runner",n.selectedRunId=null})},navigateBack:()=>{t(s=>{s.evalView="scenarios",s.selectedRunId=null})},selectRun:s=>{t(n=>{n.selectedRunId=s})},addToRunHistory:(s,n)=>{t(r=>{r.runHistory[s]||(r.runHistory[s]=[]),r.runHistory[s].unshift(n)})},loadMockData:()=>{t(s=>{s.config={available_scenarios:[{name:"Scenario 1",num_tasks:3,group:"Booking"},{name:"Scenario 2",num_tasks:2,group:"Booking"},{name:"Scenario 3",num_tasks:4,group:"Weather"},{name:"Scenario 4",num_tasks:3,group:"Weather"},{name:"Scenario 5",num_tasks:2,group:null},{name:"Scenario 6",num_tasks:5,group:null},{name:"Personality 1",num_tasks:0,group:null},{name:"Personality 2",num_tasks:0,group:null},{name:"Personality 3",num_tasks:0,group:null}],scenario_files:[{filename:"booking.json",group:"Booking",scenarios:[{name:"Scenario 1",num_tasks:3,group:"Booking"},{name:"Scenario 2",num_tasks:2,group:"Booking"}]},{filename:"weather.json",group:"Weather",scenarios:[{name:"Scenario 3",num_tasks:4,group:"Weather"},{name:"Scenario 4",num_tasks:3,group:"Weather"}]},{filename:"misc.json",group:null,scenarios:[{name:"Scenario 5",num_tasks:2,group:null},{name:"Scenario 6",num_tasks:5,group:null}]}],scenarios_dir:"/mock/scenarios"},s.isConfigLoading=!1,s.scenarios={"Scenario 1":{name:"Scenario 1",tasks:[{task:"Search for available rooms in Krakow",checkers:[{type:"tool_call",tools:["search_rooms"]}],checker_mode:"all"},{task:"Filter by deluxe rooms",checkers:[{type:"tool_call",tools:["filter_rooms"]}],checker_mode:"all"},{task:"Book a room",checkers:[{type:"tool_call",tools:["book_room"]}],checker_mode:"all"}]},"Scenario 2":{name:"Scenario 2",tasks:[{task:"Check weather",checkers:[{type:"tool_call",tools:["get_weather"]}],checker_mode:"all"},{task:"Plan activities",checkers:[{type:"llm",expected_result:"Activity list"}],checker_mode:"all"}]}},s.executions={"Scenario 1":{scenarioName:"Scenario 1",status:"completed",startTime:Date.now()-6e4,currentTurn:3,currentTaskIndex:2,currentTask:null,turns:[{turn_index:0,task_index:0,user_message:"Can you check for available rooms in Krakow on June 1, 2025?",assistant_message:`Here are the available rooms in Krak贸w on June 1, 2025:

1. **Grand Hotel Krak贸w**
   - Room 102 (Standard): 350 PLN/night
   - Room 202 (Deluxe): 500 PLN/night

2. **Hotel Stary Krak贸w**
   - Room 12 (Standard): 320 PLN/night
   - Room 22 (Deluxe): 480 PLN/night

Would you like to book any of these rooms?`,tool_calls:[{name:"search_available_rooms",arguments:{city:"Krakow",date:"2025-06-01"},result:{}}],task_completed:!0,task_completed_reason:"Listed available rooms successfully",checkers:[{type:"llm",completed:!0,reason:"Listed available rooms successfully"}],checker_mode:"all"},{turn_index:1,task_index:1,user_message:"Show me only the deluxe rooms please.",assistant_message:`Here are the deluxe rooms available:

1. **Grand Hotel Krak贸w - Room 202**
   - Price: 500 PLN/night
   - Capacity: 3 guests
   - Amenities: WiFi, TV, AC, Balcony, City View

2. **Hotel Stary Krak贸w - Room 22**
   - Price: 480 PLN/night
   - Capacity: 3 guests
   - Amenities: WiFi, TV, AC, City View, Minibar`,tool_calls:[{name:"filter_rooms",arguments:{type:"deluxe"},result:{}}],task_completed:!0,task_completed_reason:"Filtered to show only deluxe rooms",checkers:[{type:"llm",completed:!0,reason:"Filtered to show only deluxe rooms"}],checker_mode:"all"},{turn_index:2,task_index:2,user_message:"I'd like to book Room 22 at Hotel Stary for John Doe.",assistant_message:`Your reservation has been confirmed!

**Booking Details:**
- Guest: John Doe
- Hotel: Hotel Stary Krak贸w
- Room: 22 (Deluxe)
- Date: June 1, 2025
- Total: 480 PLN

Confirmation number: HSK-2025-1234`,tool_calls:[{name:"book_room",arguments:{hotel:"Hotel Stary",room:22,guest:"John Doe"},result:{confirmation:"HSK-2025-1234"}}],task_completed:!0,task_completed_reason:"Room booked successfully",checkers:[{type:"llm",completed:!0,reason:"Room booked successfully"}],checker_mode:"all"}],responseChunks:[],error:null},"Scenario 2":{scenarioName:"Scenario 2",status:"completed",startTime:Date.now()-3e4,currentTurn:2,currentTaskIndex:1,currentTask:null,turns:[{turn_index:0,task_index:0,user_message:"What's the weather like in Warsaw today?",assistant_message:`The weather in Warsaw today:

- Temperature: 22掳C
- Conditions: Partly cloudy
- Humidity: 65%
- Wind: 10 km/h NW

It's a pleasant day for outdoor activities!`,tool_calls:[{name:"get_weather",arguments:{city:"Warsaw"},result:{}}],task_completed:!0,task_completed_reason:"Weather information provided",checkers:[{type:"llm",completed:!0,reason:"Weather information provided"}],checker_mode:"all"},{turn_index:1,task_index:1,user_message:"What activities do you recommend?",assistant_message:`Based on the weather, here are some recommendations:

1. Visit the Old Town and Royal Castle
2. Walk through azienki Park
3. Explore the Warsaw Uprising Museum
4. Enjoy a riverbank cafe by the Vistula

The partly cloudy weather is perfect for sightseeing!`,tool_calls:[],task_completed:!0,task_completed_reason:"Activities recommended",checkers:[{type:"llm",completed:!0,reason:"Activities recommended"}],checker_mode:"all"}],responseChunks:[],error:null},"Scenario 3":{scenarioName:"Scenario 3",status:"timeout",startTime:Date.now()-12e4,currentTurn:2,currentTaskIndex:1,currentTask:"Complete task 2",turns:[{turn_index:0,task_index:0,user_message:"Start the process",assistant_message:"Starting the process now...",tool_calls:[],task_completed:!0,task_completed_reason:"Process started",checkers:[{type:"llm",completed:!0,reason:"Process started"}],checker_mode:"all"}],responseChunks:[],error:"Scenario timed out after 15 turns"}},s.selectedScenarioName="Scenario 1",s.runHistory={"Scenario 1":[{runId:"run-001",scenarioName:"Scenario 1",timestamp:Date.now()-6e4,status:"completed",execution:s.executions["Scenario 1"]},{runId:"run-002",scenarioName:"Scenario 1",timestamp:Date.now()-36e5,status:"failed",execution:{scenarioName:"Scenario 1",status:"failed",startTime:Date.now()-36e5,currentTurn:1,currentTaskIndex:0,currentTask:null,turns:[{turn_index:0,task_index:0,user_message:"Can you check for available rooms?",assistant_message:"I encountered an error while searching.",tool_calls:[],task_completed:!1,task_completed_reason:"API error",checkers:[{type:"llm",completed:!1,reason:"API error"}],checker_mode:"all"}],responseChunks:[],error:"Connection timeout"}}]},s.simulationRuns=[{id:"sim-run-001",timestamp:new Date(Date.now()-6e4).toISOString(),version:"v1.2.0",status:"completed",config:Re,group:"Booking",totalScenarios:3,completedScenarios:2,failedScenarios:1,totalTokens:15420,totalCostUsd:.0234,overallSuccessRate:.67,scenarioRuns:[{id:"sr_scenario_1_001",scenarioName:"Scenario 1",persona:null,status:"completed",startTime:new Date(Date.now()-6e4).toISOString(),endTime:new Date(Date.now()-45e3).toISOString(),error:null,turns:[{turn_index:0,task_index:0,user_message:"Can you check for available rooms in Krakow on June 1, 2025?",assistant_message:`Here are the available rooms in Krak贸w on June 1, 2025:

1. **Grand Hotel Krak贸w**
   - Room 102 (Standard): 350 PLN/night
   - Room 202 (Deluxe): 500 PLN/night

2. **Hotel Stary Krak贸w**
   - Room 12 (Standard): 320 PLN/night
   - Room 22 (Deluxe): 480 PLN/night`,tool_calls:[{name:"search_available_rooms",arguments:{city:"Krakow",date:"2025-06-01"},result:{}}],task_completed:!0,task_completed_reason:"Listed available rooms successfully",token_usage:{total:450,prompt:120,completion:330},latency_ms:1200},{turn_index:1,task_index:1,user_message:"Show me only the deluxe rooms please.",assistant_message:`Here are the deluxe rooms available:

1. **Grand Hotel Krak贸w - Room 202** - 500 PLN/night
2. **Hotel Stary Krak贸w - Room 22** - 480 PLN/night`,tool_calls:[{name:"filter_rooms",arguments:{type:"deluxe"},result:{}}],task_completed:!0,task_completed_reason:"Filtered to show only deluxe rooms",token_usage:{total:320,prompt:100,completion:220},latency_ms:890},{turn_index:2,task_index:2,user_message:"I'd like to book Room 22 at Hotel Stary for John Doe.",assistant_message:`Your reservation has been confirmed!

**Booking Details:**
- Guest: John Doe
- Hotel: Hotel Stary Krak贸w
- Room: 22 (Deluxe)
- Total: 480 PLN

Confirmation number: HSK-2025-1234`,tool_calls:[{name:"book_room",arguments:{hotel:"Hotel Stary",room:22,guest:"John Doe"},result:{confirmation:"HSK-2025-1234"}}],task_completed:!0,task_completed_reason:"Room booked successfully",token_usage:{total:380,prompt:150,completion:230},latency_ms:1100}],tasks:[{task_index:0,description:"Search for available rooms in Krakow",completed:!0,turns_taken:1,final_reason:"Listed available rooms successfully"},{task_index:1,description:"Filter by deluxe rooms",completed:!0,turns_taken:1,final_reason:"Filtered to show only deluxe rooms"},{task_index:2,description:"Book a room",completed:!0,turns_taken:1,final_reason:"Room booked successfully"}],metrics:{total_turns:3,total_tasks:3,tasks_completed:3,success_rate:1,total_tokens:1150,prompt_tokens:370,completion_tokens:780,estimated_usd:.0089,deepeval_scores:{},custom:{}}},{id:"sr_scenario_2_001",scenarioName:"Scenario 2",persona:null,status:"completed",startTime:new Date(Date.now()-44e3).toISOString(),endTime:new Date(Date.now()-3e4).toISOString(),error:null,turns:[{turn_index:0,task_index:0,user_message:"What's the weather like in Warsaw today?",assistant_message:`The weather in Warsaw today:

- Temperature: 22掳C
- Conditions: Partly cloudy
- Humidity: 65%
- Wind: 10 km/h NW`,tool_calls:[{name:"get_weather",arguments:{city:"Warsaw"},result:{}}],task_completed:!0,task_completed_reason:"Weather information provided",token_usage:{total:280,prompt:80,completion:200},latency_ms:750},{turn_index:1,task_index:1,user_message:"What activities do you recommend?",assistant_message:`Based on the weather, here are some recommendations:

1. Visit the Old Town
2. Walk through azienki Park
3. Explore the Warsaw Uprising Museum`,tool_calls:[],task_completed:!0,task_completed_reason:"Activities recommended",token_usage:{total:250,prompt:90,completion:160},latency_ms:680}],tasks:[{task_index:0,description:"Check weather",completed:!0,turns_taken:1,final_reason:"Weather information provided"},{task_index:1,description:"Plan activities",completed:!0,turns_taken:1,final_reason:"Activities recommended"}],metrics:{total_turns:2,total_tasks:2,tasks_completed:2,success_rate:1,total_tokens:530,prompt_tokens:170,completion_tokens:360,estimated_usd:.0045,deepeval_scores:{},custom:{}}},{id:"sr_scenario_3_001",scenarioName:"Scenario 3",persona:null,status:"timeout",startTime:new Date(Date.now()-29e3).toISOString(),endTime:new Date(Date.now()-1e4).toISOString(),error:"Scenario timed out after 15 turns",turns:[{turn_index:0,task_index:0,user_message:"Start the process",assistant_message:"Starting the process now...",tool_calls:[],task_completed:!0,task_completed_reason:"Process started",token_usage:{total:100,prompt:40,completion:60},latency_ms:500}],tasks:[{task_index:0,description:"Start the process",completed:!0,turns_taken:1,final_reason:"Process started"},{task_index:1,description:"Complete task 2",completed:!1,turns_taken:14,final_reason:"Timeout"}],metrics:{total_turns:15,total_tasks:4,tasks_completed:1,success_rate:.25,total_tokens:13740,prompt_tokens:4500,completion_tokens:9240,estimated_usd:.01,deepeval_scores:{},custom:{}}}]},{id:"sim-run-002",timestamp:new Date(Date.now()-36e5).toISOString(),version:"v1.1.0",status:"completed",config:Re,group:null,totalScenarios:2,completedScenarios:2,failedScenarios:0,totalTokens:8500,totalCostUsd:.012,overallSuccessRate:1,scenarioRuns:[{id:"sr_scenario_1_002",scenarioName:"Scenario 1",persona:null,status:"completed",startTime:new Date(Date.now()-36e5).toISOString(),endTime:new Date(Date.now()-359e4).toISOString(),error:null,turns:[{turn_index:0,task_index:0,user_message:"Find me a room in Krakow",assistant_message:"I found several rooms available in Krakow.",tool_calls:[{name:"search_rooms",arguments:{city:"Krakow"},result:{}}],task_completed:!0,task_completed_reason:"Rooms found",token_usage:{total:200,prompt:60,completion:140},latency_ms:600}],tasks:[{task_index:0,description:"Search for rooms",completed:!0,turns_taken:1,final_reason:"Rooms found"}],metrics:{total_turns:1,total_tasks:1,tasks_completed:1,success_rate:1,total_tokens:200,prompt_tokens:60,completion_tokens:140,estimated_usd:.002,deepeval_scores:{},custom:{}}},{id:"sr_scenario_2_002",scenarioName:"Scenario 2",persona:null,status:"completed",startTime:new Date(Date.now()-3589e3).toISOString(),endTime:new Date(Date.now()-358e4).toISOString(),error:null,turns:[{turn_index:0,task_index:0,user_message:"What's the weather?",assistant_message:"It's sunny and 25掳C.",tool_calls:[{name:"get_weather",arguments:{},result:{}}],task_completed:!0,task_completed_reason:"Weather provided",token_usage:{total:150,prompt:50,completion:100},latency_ms:450}],tasks:[{task_index:0,description:"Check weather",completed:!0,turns_taken:1,final_reason:"Weather provided"}],metrics:{total_turns:1,total_tasks:1,tasks_completed:1,success_rate:1,total_tokens:150,prompt_tokens:50,completion_tokens:100,estimated_usd:.0015,deepeval_scores:{},custom:{}}}]}]})}}}))),yt=t=>{const a=Object.values(t.executions),s=a.length,n=a.filter(l=>l.status==="completed").length,r=a.filter(l=>l.status==="failed"||l.status==="timeout").length,o=a.filter(l=>l.status==="running"||l.status==="queued").length,i=s>0?(n+r)/s*100:0;return{total:s,completed:n,failed:r,running:o,percentage:i}},De=f.createContext(null);function St({children:t}){const a=f.useRef(null);return a.current||(a.current=Nt()),e.jsx(De.Provider,{value:a.current,children:t})}function K(t){const a=f.useContext(De);if(!a)throw new Error("useEvalStore must be used within EvalStoreProvider");return Rs(a,t)}function X(){const t=f.useContext(De);if(!t)throw new Error("useEvalStoreApi must be used within EvalStoreProvider");return t}const He=[{key:"runs",label:"Runs",icon:"heroicons:play-circle",path:"/runs"},{key:"new",label:"New Run",icon:"heroicons:plus-circle",path:"/new"},{key:"scenarios",label:"Scenarios",icon:"heroicons:document-text",path:"/scenarios"},{key:"personas",label:"Personas",icon:"heroicons:user",path:"/personas"},{key:"playground",label:"Playground",icon:"heroicons:beaker",path:"/playground"}];function wt(){const t=Ts(),a=ue(),s=()=>{const r=t.pathname;return r.startsWith("/runs")?"runs":r.startsWith("/new")?"new":r.startsWith("/scenarios")?"scenarios":r.startsWith("/personas")?"personas":r.startsWith("/playground")?"playground":"runs"},n=r=>{const o=He.find(i=>i.key===r);o&&a(o.path)};return e.jsx("div",{className:"border-b border-divider px-6",children:e.jsx(rs,{selectedKey:s(),onSelectionChange:n,variant:"underlined",classNames:{tabList:"gap-6",cursor:"bg-primary",tab:"px-0 h-12"},children:He.map(r=>e.jsx(ke,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{icon:r.icon,className:"text-lg"}),e.jsx("span",{children:r.label})]})},r.key))})})}function Ct(){const{theme:t,setTheme:a}=Ps(),s=t===Ce.DARK,n=()=>a(s?Ce.LIGHT:Ce.DARK);return e.jsxs("div",{className:"flex h-screen flex-col overflow-hidden bg-background",children:[e.jsxs("header",{className:"flex items-center justify-between border-b border-divider px-6 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"И"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"Ragbits Evaluation"}),e.jsx("p",{className:"text-xs text-foreground-500",children:"Test scenarios and view results"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(W,{isIconOnly:!0,variant:"light",onPress:n,"aria-label":"Toggle theme",children:e.jsx(y,{icon:s?"heroicons:sun":"heroicons:moon",className:"text-xl"})})})]}),e.jsx(wt,{}),e.jsx("main",{className:"flex-1 min-h-0 overflow-hidden",children:e.jsx($s,{})})]})}const Rt={completed:{color:"success",label:"Completed"},failed:{color:"danger",label:"Failed"},timeout:{color:"warning",label:"Timeout"},running:{color:"primary",label:"Running"},queued:{color:"default",label:"Queued"},idle:{color:"default",label:"Idle"}};function Tt(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Pt(t){return t<.01?"<$0.01":`$${t.toFixed(2)}`}function $t(t){return t>=1e3?`${(t/1e3).toFixed(1)}k`:t.toString()}function Dt(t,a){const s=new Set(t.scenarioRuns.map(r=>r.scenarioName)),n=[];for(const[r,o]of a)o.every(l=>s.has(l))&&o.length>0&&n.push(r);return n.sort()}function It({runs:t,groupScenarios:a,onViewDetails:s,onRerun:n}){return e.jsxs(Bs,{"aria-label":"Simulation runs",classNames:{wrapper:"shadow-none"},children:[e.jsxs(Gs,{children:[e.jsx(re,{children:"SCENARIOS"}),e.jsx(re,{children:"DATE"}),e.jsx(re,{children:"VERSION"}),e.jsx(re,{children:"RESULTS"}),e.jsx(re,{width:180,children:"ACTIONS"})]}),e.jsx(Js,{children:t.map(r=>{const o=Rt[r.status],i=r.scenarioRuns.map(p=>p.scenarioName),l=i.length<=2?i.join(", "):`${i.slice(0,2).join(", ")} +${i.length-2}`,m=Dt(r,a);return e.jsxs(qs,{children:[e.jsx(oe,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:l}),m.map(p=>e.jsx(M,{size:"sm",variant:"flat",color:"secondary",children:p},p))]}),e.jsxs("p",{className:"text-xs text-foreground-400",children:[r.totalScenarios," scenario",r.totalScenarios!==1?"s":""]})]})}),e.jsx(oe,{children:e.jsx("span",{className:"text-foreground-500",children:Tt(r.timestamp)})}),e.jsx(oe,{children:e.jsx("span",{className:"text-foreground-500 font-mono text-sm",children:r.version})}),e.jsx(oe,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{size:"sm",color:o.color,variant:"flat",children:o.label}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-foreground-500",children:[e.jsxs("span",{title:"Success rate",children:[Math.round(r.overallSuccessRate*100),"%"]}),e.jsxs("span",{title:"Scenarios",className:"flex items-center gap-1",children:[e.jsx(y,{icon:"heroicons:check-circle",className:"text-xs text-success"}),r.completedScenarios,"/",r.totalScenarios]}),e.jsxs("span",{title:"Tokens",className:"flex items-center gap-1",children:[e.jsx(y,{icon:"heroicons:cpu-chip",className:"text-xs"}),$t(r.totalTokens)]}),e.jsxs("span",{title:"Cost",className:"flex items-center gap-1",children:[e.jsx(y,{icon:"heroicons:currency-dollar",className:"text-xs"}),Pt(r.totalCostUsd)]})]})]})}),e.jsx(oe,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(st,{children:[e.jsx(tt,{children:e.jsx(W,{size:"sm",variant:"flat",endContent:e.jsx(y,{icon:"heroicons:chevron-down"}),children:"Details"})}),e.jsxs(nt,{"aria-label":"Run actions",children:[e.jsx(Me,{startContent:e.jsx(y,{icon:"heroicons:eye"}),onPress:()=>s(r.id),children:"View details"},"view"),e.jsx(Me,{startContent:e.jsx(y,{icon:"heroicons:chart-bar"}),onPress:()=>s(r.id),children:"View metrics"},"metrics")]})]}),e.jsx(W,{size:"sm",variant:"bordered",onPress:()=>n(r.id),startContent:e.jsx(y,{icon:"heroicons:arrow-path"}),children:"Run"})]})})]},r.id)})})]})}function Ft(){const{client:t}=Y(),a=X(),s=ue(),n=K(h=>h.config),r=K(h=>h.simulationRuns),o=K(h=>h.isSimulationRunsLoading),i=Array.isArray(r)?r:[],[l,m]=f.useState(new Set(["all"])),{scenarios:p,groupScenarios:b}=f.useMemo(()=>{if(!n)return{scenarios:[],groupScenarios:new Map};const h=n.available_scenarios.filter(d=>!se(d.num_tasks)),v=new Map;for(const d of h)d.group&&(v.has(d.group)||v.set(d.group,[]),v.get(d.group).push(d.name));return{scenarios:h.map(d=>d.name),groupScenarios:v}},[n]),g=f.useMemo(()=>l.has("all")?i:i.filter(h=>h.scenarioRuns.some(v=>l.has(v.scenarioName))),[i,l]);f.useEffect(()=>{async function h(){const{setSimulationRunsLoading:v,setSimulationRuns:d}=a.getState().actions;v(!0);try{const w=((await t.makeRequest("/api/eval/runs"))?.runs??[]).map(R=>({id:R.id,timestamp:R.timestamp,version:R.version||"current",status:R.status,scenarioRuns:(R.scenario_runs||[]).map($=>({id:$.id,scenarioName:$.scenario_name,persona:$.persona||null,status:$.status,startTime:$.start_time,endTime:$.end_time,turns:[],tasks:[],responseChunks:[],metrics:{total_turns:$.total_turns||0,total_tasks:$.total_tasks||0,tasks_completed:$.tasks_completed||0,success_rate:$.success_rate||0,total_tokens:$.total_tokens||0,prompt_tokens:0,completion_tokens:0,total_cost_usd:$.total_cost_usd||0,deepeval_scores:{},custom:{}},error:$.error})),config:{max_turns_scenario:15,max_turns_task:4,sim_user_model_name:null,checker_model_name:null,default_model:"gpt-4o-mini",persona:null},group:R.group||null,totalScenarios:R.total_scenarios||0,completedScenarios:R.completed_scenarios||0,failedScenarios:R.failed_scenarios||0,totalTokens:R.total_tokens||0,totalCostUsd:R.total_cost_usd||0,overallSuccessRate:R.overall_success_rate||0}));d(w)}catch(N){console.error("Failed to load simulation runs:",N),d([])}}h()},[t,a]);const u=f.useCallback(h=>{s(`/runs/${h}`)},[s]),j=f.useCallback(h=>{const v=i.find(d=>d.id===h);if(v){const d=v.scenarioRuns.map(N=>N.scenarioName).join(",");s(`/new?scenarios=${encodeURIComponent(d)}`)}},[s,i]),c=f.useCallback(()=>{s("/new")},[s]),x=f.useCallback(h=>{if(h==="all")m(new Set(["all"]));else{const v=new Set(h);v.has("all")&&v.size>1&&v.delete("all"),v.size===0&&v.add("all"),m(v)}},[]);return n?e.jsxs("div",{className:"flex h-full",children:[e.jsxs("aside",{className:"w-56 flex-shrink-0 border-r border-divider p-4",children:[e.jsx("h2",{className:"mb-3 text-sm font-semibold text-foreground-500 uppercase tracking-wide",children:"Scenarios"}),e.jsx(Zs,{"aria-label":"Filter by scenario",selectionMode:"multiple",selectedKeys:l,onSelectionChange:x,items:[{key:"all",label:"All Scenarios"},...p.map(h=>({key:h,label:h}))],classNames:{list:"gap-1"},children:h=>e.jsx(Ze,{className:"text-sm",children:h.label},h.key)})]}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-divider px-6 py-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Simulation Runs"}),e.jsxs("p",{className:"text-sm text-foreground-500",children:[g.length," run",g.length!==1?"s":""," ",!l.has("all")&&"(filtered)"]})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:o?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(V,{size:"lg"})}):g.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center",children:[e.jsx(y,{icon:"heroicons:inbox",className:"text-6xl text-foreground-300 mb-4"}),e.jsx("p",{className:"text-foreground-500",children:"No runs found"}),e.jsx("p",{className:"text-sm text-foreground-400 mt-1",children:"Start a new run to see results here"})]}):e.jsx(It,{runs:g,groupScenarios:b,onViewDetails:u,onRerun:j})}),e.jsx("div",{className:"flex justify-end border-t border-divider px-6 py-4",children:e.jsx(W,{color:"success",onPress:c,startContent:e.jsx(y,{icon:"heroicons:sparkles"}),children:"New run"})})]})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(V,{size:"lg"})})}const ve={completed:{color:"success",label:"Completed"},failed:{color:"danger",label:"Failed"},timeout:{color:"warning",label:"Timeout"},running:{color:"primary",label:"Running"},queued:{color:"default",label:"Queued"},idle:{color:"default",label:"Idle"}};function Lt({scenarioRuns:t,onRerun:a}){const s=f.useMemo(()=>{let r=0,o=0,i=0,l=0;const m=[],p=[];for(const j of t){if(!j.metrics)continue;const c=j.metrics;r+=c.total_turns??0,o+=c.total_tasks??0,i+=c.tasks_completed??0,l+=c.estimated_usd??0,c.latency_avg_ms&&m.push(c.latency_avg_ms),c.time_to_first_token_avg_ms&&p.push(c.time_to_first_token_avg_ms)}const b=o>0?i/o:0,g=m.length>0?m.reduce((j,c)=>j+c,0)/m.length:0,u=p.length>0?p.reduce((j,c)=>j+c,0)/p.length:0;return{totalTurns:r,totalTasks:o,tasksCompleted:i,successRate:b,estimatedUsd:l,avgLatency:g,avgTtft:u}},[t]),n=s.successRate>=.9?"success":s.successRate>=.7?"warning":"danger";return e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-5 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-foreground-400",children:"Turns"}),e.jsx("p",{className:"font-semibold",children:s.totalTurns})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-foreground-400",children:"Tasks"}),e.jsxs("p",{className:"font-semibold",children:[s.tasksCompleted,"/",s.totalTasks]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-foreground-400",children:"Success"}),e.jsxs("p",{className:`font-semibold text-${n}`,children:[(s.successRate*100).toFixed(0),"%"]})]}),s.avgLatency>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-foreground-400",children:"Latency"}),e.jsxs("p",{className:"font-semibold",children:[s.avgLatency.toFixed(0),"ms"]})]}),s.avgTtft>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-foreground-400",children:"TTFT"}),e.jsxs("p",{className:"font-semibold",children:[s.avgTtft.toFixed(0),"ms"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-foreground-400",children:"Cost"}),e.jsxs("p",{className:"font-semibold",children:["$",s.estimatedUsd.toFixed(4)]})]})]}),e.jsx(W,{color:"primary",variant:"flat",onPress:a,startContent:e.jsx(y,{icon:"heroicons:arrow-path"}),children:"Rerun"})]})}function Mt(t){return{id:t.id,timestamp:t.timestamp,version:t.version||"current",status:t.status,scenarioRuns:(t.scenario_runs||[]).map(a=>({id:a.id,scenarioName:a.scenario_name,persona:a.persona||null,status:a.status,startTime:a.start_time,endTime:a.end_time,turns:(a.turns||[]).map(s=>({turn_index:s.turn_index,task_index:s.task_index,user_message:s.user_message,assistant_message:s.assistant_message,tool_calls:s.tool_calls||[],task_completed:s.task_completed,task_completed_reason:s.task_completed_reason,token_usage:s.token_usage,latency_ms:s.latency_ms,checkers:(s.checkers||[]).map(n=>({type:n.type,completed:n.completed,reason:n.reason})),checker_mode:s.checker_mode||"all"})),tasks:(a.tasks||[]).map(s=>({task_index:s.task_index,description:s.description,completed:s.completed,turns_taken:s.turns_taken,final_reason:s.final_reason})),responseChunks:(a.response_chunks||[]).map(s=>({turn_index:s.turn_index,task_index:s.task_index,chunk_index:s.chunk_index,chunk_type:s.chunk_type,chunk_data:s.chunk_data})),metrics:a.metrics,error:a.error})),config:{max_turns_scenario:15,max_turns_task:4,sim_user_model_name:null,checker_model_name:null,default_model:"gpt-4o-mini",persona:null},group:t.group||null,totalScenarios:t.total_scenarios||0,completedScenarios:t.completed_scenarios||0,failedScenarios:t.failed_scenarios||0,totalTokens:t.total_tokens||0,totalCostUsd:t.total_cost_usd||0,overallSuccessRate:t.overall_success_rate||0}}function At(){const{runId:t}=Qe(),a=ue(),{client:s}=Y(),n=K(d=>d.simulationRuns),[r,o]=f.useState(null),[i,l]=f.useState(!0),[m,p]=f.useState(0),[b,g]=f.useState(new Set),u=n.find(d=>d.id===t)??null;f.useEffect(()=>{async function d(){if(t){l(!0);try{const N=await s.makeRequest(`/api/eval/runs/${t}`);o(Mt(N))}catch{console.debug("Run not found in API, using store data")}finally{l(!1)}}}d()},[t,s]);const j=r??u,c=j?.scenarioRuns[m]??null,x=f.useCallback(async d=>{if(p(d),!t||r||!u)return;const N=u.scenarioRuns[d];if(!(!N?.id||b.has(N.id)))try{const w=(await s.makeRequest(`/api/eval/progress/${t}/buffer/${N.id}`))?.events??[];w.length>0&&(g(R=>new Set(R).add(N.id)),console.debug(`Fetched ${w.length} buffered events for ${N.id}`))}catch(_){console.debug("Could not fetch buffered events:",_)}},[t,r,u,b,s]),h=f.useCallback(()=>{a("/runs")},[a]),v=f.useCallback(()=>{if(j){const d=j.scenarioRuns.map(N=>N.scenarioName).join(",");a(`/new?scenarios=${encodeURIComponent(d)}`)}},[a,j]);return i?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(V,{size:"lg"})}):j?e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-divider px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(W,{isIconOnly:!0,variant:"light",onPress:h,"aria-label":"Back",children:e.jsx(y,{icon:"heroicons:arrow-left",className:"text-xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Simulation Run"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-foreground-500",children:[e.jsx("span",{children:new Date(j.timestamp).toLocaleString()}),e.jsx("span",{className:"font-mono",children:j.version}),e.jsx(M,{size:"sm",color:ve[j.status].color,variant:"flat",children:ve[j.status].label})]})]})]}),e.jsx(Lt,{scenarioRuns:j.scenarioRuns,onRerun:v})]}),e.jsxs("div",{className:"flex flex-1 min-h-0",children:[e.jsxs("aside",{className:"w-96 flex-shrink-0 border-r border-divider overflow-y-auto p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-foreground-500 uppercase tracking-wide mb-3",children:["Scenarios (",j.scenarioRuns.length,")"]}),e.jsx("div",{className:"space-y-2",children:j.scenarioRuns.map((d,N)=>e.jsx(L,{isPressable:!0,onPress:()=>x(N),className:`w-full ${m===N?"border-2 border-primary":""}`,children:e.jsxs(F,{className:"p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:d.scenarioName}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-foreground-400",children:[e.jsxs("span",{children:[d.turns.length," turns, ",d.tasks.length," tasks"]}),d.persona&&e.jsx(M,{size:"sm",variant:"flat",className:"text-xs",children:d.persona})]})]}),e.jsx(M,{size:"sm",color:ve[d.status].color,variant:"flat",children:ve[d.status].label})]}),d.metrics&&e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-foreground-500",children:[e.jsxs("span",{children:[Math.round(d.metrics.success_rate*100),"%"]}),e.jsxs("span",{children:[d.metrics.total_tokens," tokens"]})]})]})},d.id||d.scenarioName))})]}),e.jsx("main",{className:"flex-1 min-h-0 overflow-hidden",children:c?e.jsx(Kt,{scenarioRun:c}):e.jsx("div",{className:"flex h-full items-center justify-center text-foreground-500",children:"Select a scenario to view details"})})]})]}):e.jsxs("div",{className:"flex h-full flex-col items-center justify-center",children:[e.jsx(y,{icon:"heroicons:exclamation-triangle",className:"text-6xl text-danger mb-4"}),e.jsx("p",{className:"text-foreground-500",children:"Run not found"}),e.jsx(W,{className:"mt-4",onPress:h,children:"Back to Runs"})]})}function Kt({scenarioRun:t}){const[a,s]=f.useState("conversation"),n=t.responseChunks?.length||0;return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"border-b border-divider px-6 py-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.scenarioName}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-foreground-500",children:[e.jsxs("span",{children:[t.tasks.filter(r=>r.completed).length,"/",t.tasks.length," tasks completed"]}),t.persona&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx(M,{size:"sm",variant:"flat",children:t.persona})]})]})]})}),t.error&&e.jsx("div",{className:"mt-2 p-2 bg-danger-50 dark:bg-danger-900/20 rounded-lg text-danger text-sm",children:t.error})]}),e.jsx("div",{className:"border-b border-divider px-6 py-2",children:e.jsxs(rs,{selectedKey:a,onSelectionChange:r=>s(r),size:"sm",variant:"underlined",children:[e.jsx(ke,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{icon:"heroicons:chat-bubble-left-right"}),e.jsx("span",{children:"Conversation"})]})},"conversation"),e.jsx(ke,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{icon:"heroicons:squares-2x2"}),e.jsx("span",{children:"Responses"}),n>0&&e.jsx(M,{size:"sm",variant:"flat",className:"ml-1",children:n})]})},"responses"),e.jsx(ke,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{icon:"heroicons:chart-bar"}),e.jsx("span",{children:"Metrics"})]})},"metrics")]})}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-6",children:a==="conversation"?e.jsx(Ot,{turns:t.turns,tasks:t.tasks}):a==="responses"?e.jsx(Ht,{scenarioRun:t}):e.jsx(Qt,{metrics:t.metrics})})]})}function Et({checkers:t}){return!t||t.length===0?null:e.jsx("div",{className:"mt-2 space-y-2",children:t.map((a,s)=>e.jsxs("div",{className:`flex items-start gap-2 p-2 rounded ${a.completed?"bg-success/10":"bg-default-100"}`,children:[e.jsx(y,{icon:a.completed?"heroicons:check-circle":"heroicons:x-circle",className:`text-sm flex-shrink-0 mt-0.5 ${a.completed?"text-success":"text-default-400"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(M,{size:"sm",variant:"bordered",className:"text-xs",children:a.type})}),e.jsx("p",{className:"text-xs text-foreground-500 mt-1",children:a.reason})]})]},s))})}function Ot({turns:t,tasks:a}){if(t.length===0)return e.jsx("div",{className:"flex h-full items-center justify-center text-foreground-500",children:"No conversation data"});const s=n=>a.find(r=>r.task_index===n);return e.jsx("div",{className:"space-y-4",children:t.map((n,r)=>{const o=r>0?t[r-1].task_index:-1,i=n.task_index!==o,l=i?s(n.task_index):null;return e.jsxs("div",{className:"space-y-3",children:[i&&e.jsxs("div",{className:"flex items-center gap-3 py-3",children:[e.jsx("div",{className:"flex-1 h-px bg-primary/30"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 border border-primary/20",children:[e.jsx(y,{icon:"heroicons:flag",className:"text-primary text-sm"}),e.jsxs("span",{className:"text-sm font-medium text-primary",children:["Task ",n.task_index+1]})]}),e.jsx("div",{className:"flex-1 h-px bg-primary/30"})]}),i&&l&&e.jsx("div",{className:"mx-4 p-3 rounded-lg bg-primary/5 border border-primary/20 mb-4",children:e.jsx("p",{className:"text-sm text-foreground-600",children:l.description})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center flex-shrink-0",children:e.jsx(y,{icon:"heroicons:user",className:"text-white text-sm"})}),e.jsxs("div",{className:"flex-1 p-3 rounded-lg bg-content2",children:[e.jsx("p",{className:"text-xs text-foreground-500 mb-1",children:"Simulated User"}),e.jsx("p",{children:n.user_message})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-secondary flex items-center justify-center flex-shrink-0",children:e.jsx(y,{icon:"heroicons:cpu-chip",className:"text-white text-sm"})}),e.jsxs("div",{className:"flex-1 p-3 rounded-lg bg-content2",children:[e.jsx("p",{className:"text-xs text-foreground-500 mb-1",children:"Assistant"}),e.jsx("p",{className:"whitespace-pre-wrap",children:n.assistant_message}),n.tool_calls.length>0&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-divider",children:[e.jsx("p",{className:"text-xs text-foreground-500 mb-1",children:"Tool calls:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.tool_calls.map((m,p)=>e.jsx(M,{size:"sm",variant:"flat",children:m.name},p))})]})]})]}),e.jsx("div",{className:`mx-4 p-3 rounded-lg border ${n.task_completed?"border-success bg-success/5":"border-default-200 bg-default-50"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${n.task_completed?"bg-success":"bg-default-300"}`,children:e.jsx(y,{icon:n.task_completed?"heroicons:check":"heroicons:x-mark",className:"text-white text-sm"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("p",{className:"text-xs font-medium text-foreground-500",children:"Checker Decision"}),e.jsx(M,{size:"sm",color:n.task_completed?"success":"default",variant:"flat",children:n.task_completed?"Completed":"Not Completed"}),(n.checkers?.length??0)>1&&e.jsxs(M,{size:"sm",variant:"bordered",className:"text-xs",children:["mode: ",n.checker_mode??"all"]})]}),n.task_completed_reason&&e.jsx("p",{className:"text-sm text-foreground-600 mb-2",children:n.task_completed_reason}),e.jsx(Et,{checkers:n.checkers??[]})]})]})})]},r)})})}const Ue={text:{color:"primary",icon:"heroicons:document-text",label:"Text"},reference:{color:"success",icon:"heroicons:bookmark",label:"Reference"},tool_call:{color:"warning",icon:"heroicons:wrench",label:"Tool Call"},usage:{color:"secondary",icon:"heroicons:chart-bar",label:"Usage"},live_update:{color:"primary",icon:"heroicons:arrow-path",label:"Live Update"},checker_decision:{color:"secondary",icon:"heroicons:scale",label:"Checker"},error:{color:"danger",icon:"heroicons:exclamation-triangle",label:"Error"},unknown:{color:"default",icon:"heroicons:question-mark-circle",label:"Unknown"}};function Z(t){return Ue[t]||Ue.unknown}function Wt(t){return"_aggregated"in t&&t._aggregated===!0}function zt({chunk:t}){const a=Z("text");return e.jsx(L,{className:"shadow-sm bg-default-50",children:e.jsx(F,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 bg-${a.color}/10`,children:e.jsx(y,{icon:a.icon,className:`text-${a.color} text-lg`})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(M,{size:"sm",color:a.color,variant:"flat",children:[t.count," text chunk",t.count>1?"s":""]}),e.jsxs("span",{className:"text-xs text-foreground-500",children:["Turn ",t.turn_index+1]})]})]})})})}function Ht({scenarioRun:t}){const a=t.responseChunks||[],s=f.useMemo(()=>{const n=[];let r=0,o=null;for(const i of a)i.chunk_type==="text"?(r===0&&(o=i),r++):(r>0&&o&&(n.push({_aggregated:!0,count:r,turn_index:o.turn_index,chunk_index:o.chunk_index}),r=0,o=null),n.push(i));return r>0&&o&&n.push({_aggregated:!0,count:r,turn_index:o.turn_index,chunk_index:o.chunk_index}),n},[a]);return a.length===0?e.jsxs("div",{className:"flex h-64 flex-col items-center justify-center text-center",children:[e.jsx(y,{icon:"heroicons:squares-2x2",className:"text-5xl text-foreground-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground",children:"No Response Chunks"}),e.jsx("p",{className:"text-sm text-foreground-500 mt-2",children:"Response chunks are only available for live runs"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold",children:"Response Stream"}),e.jsxs(M,{size:"sm",variant:"flat",children:[a.length," chunks"]})]}),s.map((n,r)=>Wt(n)?e.jsx(zt,{chunk:n},`agg-${n.turn_index}-${n.chunk_index}`):e.jsx(L,{className:"shadow-sm",children:e.jsx(F,{className:"p-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 bg-${Z(n.chunk_type).color}/10`,children:e.jsx(y,{icon:Z(n.chunk_type).icon,className:`text-${Z(n.chunk_type).color} text-lg`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsx(M,{size:"sm",color:Z(n.chunk_type).color,variant:"flat",children:Z(n.chunk_type).label}),e.jsxs("span",{className:"text-xs text-foreground-500",children:["Turn ",n.turn_index+1,"  Task ",n.task_index+1]})]}),e.jsx("pre",{className:"text-xs p-2 bg-default-100 rounded overflow-auto max-h-32",children:JSON.stringify(n.chunk_data,null,2)})]})]})})},r))]})}function Ut(t,a){return a==null?"N/A":typeof a=="number"?t.includes("rate")||t.includes("success")?`${Math.round(a*100)}%`:t.includes("cost")||t.includes("usd")?`$${a.toFixed(4)}`:t.includes("_ms")||t.includes("latency")||t.includes("time_to")?`${a.toFixed(1)} ms`:Number.isInteger(a)?a.toLocaleString():a.toFixed(2):Array.isArray(a)?a.length>0?a.join(", "):"None":typeof a=="object"?JSON.stringify(a):String(a)}function Vt(t){return t.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}function Bt({metrics:t}){const a=t.success_rate??0,s=a<=1?a*100:a,n=s>=90?"success":s>=70?"warning":"danger";return e.jsx(L,{className:"bg-gradient-to-br from-content1 to-content2",children:e.jsxs(F,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{icon:"heroicons:chart-pie",className:"text-lg text-primary"}),e.jsx("h4",{className:"font-semibold",children:"Overview"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold",children:t.total_turns??0}),e.jsx("p",{className:"text-xs text-foreground-500 mt-1",children:"Total Turns"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:[t.tasks_completed??0,"/",t.total_tasks??0]}),e.jsx("p",{className:"text-xs text-foreground-500 mt-1",children:"Tasks Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full bg-${n}`}),e.jsxs("p",{className:"text-3xl font-bold",children:[s.toFixed(0),"%"]})]}),e.jsx("p",{className:"text-xs text-foreground-500 mt-1",children:"Success Rate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:["$",(t.estimated_usd??0).toFixed(4)]}),e.jsx("p",{className:"text-xs text-foreground-500 mt-1",children:"Estimated Cost"})]})]})]})})}function Gt({metrics:t}){const a=t.latency_avg_ms??0,s=t.latency_min_ms??0,n=t.latency_max_ms??0,r=t.time_to_first_token_avg_ms??0,o=t.time_to_first_token_min_ms??0,i=t.time_to_first_token_max_ms??0;return e.jsx(L,{children:e.jsxs(F,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{icon:"heroicons:clock",className:"text-lg text-warning"}),e.jsx("h4",{className:"font-semibold",children:"Latency"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-foreground-500 mb-2",children:"Response Time"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"text-2xl font-bold",children:a.toFixed(0)}),e.jsx("p",{className:"text-sm text-foreground-500",children:"ms avg"})]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-foreground-400",children:[e.jsxs("span",{children:["Min: ",s.toFixed(0),"ms"]}),e.jsxs("span",{children:["Max: ",n.toFixed(0),"ms"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-foreground-500 mb-2",children:"Time to First Token"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"text-2xl font-bold",children:r.toFixed(0)}),e.jsx("p",{className:"text-sm text-foreground-500",children:"ms avg"})]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-foreground-400",children:[e.jsxs("span",{children:["Min: ",o.toFixed(0),"ms"]}),e.jsxs("span",{children:["Max: ",i.toFixed(0),"ms"]})]})]})]})]})})}function Jt({metrics:t}){const a=t.tokens_total??t.total_tokens??0,s=t.tokens_prompt??t.prompt_tokens??0,n=t.tokens_completion??t.completion_tokens??0,r=t.tokens_avg_per_turn??0,o=a>0?s/a*100:0;return e.jsx(L,{children:e.jsxs(F,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{icon:"heroicons:calculator",className:"text-lg text-secondary"}),e.jsx("h4",{className:"font-semibold",children:"Token Usage"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-3xl font-bold",children:a.toLocaleString()}),e.jsx("p",{className:"text-xs text-foreground-500 mt-1",children:"Total Tokens"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 rounded-full bg-default-200 overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${o}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs",children:[e.jsxs("span",{className:"text-primary",children:[s.toLocaleString()," prompt"]}),e.jsxs("span",{className:"text-foreground-500",children:[n.toLocaleString()," completion"]})]})]}),r>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold",children:r.toLocaleString()}),e.jsx("p",{className:"text-xs text-foreground-500",children:"avg/turn"})]})]})]})})}function qt({metrics:t}){const a=t.tools_total_calls??0,s=t.tools_unique,n=t.tools_counts,r=Array.isArray(s)?s:typeof s=="string"?s.split(",").map(o=>o.trim()).filter(Boolean):[];return e.jsx(L,{children:e.jsxs(F,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{icon:"heroicons:wrench-screwdriver",className:"text-lg text-warning"}),e.jsx("h4",{className:"font-semibold",children:"Tool Usage"})]}),e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold",children:a}),e.jsx("p",{className:"text-xs text-foreground-500 mt-1",children:"Total Calls"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-foreground-500 mb-2",children:"Tools Used"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n?Object.entries(n).map(([o,i])=>e.jsxs(M,{size:"sm",variant:"flat",children:[o," ",e.jsxs("span",{className:"text-foreground-400 ml-1",children:["",i]})]},o)):r.length>0?r.map(o=>e.jsx(M,{size:"sm",variant:"flat",children:o},o)):e.jsx("span",{className:"text-foreground-500 text-sm",children:"No tools used"})})]})]})]})})}function Yt({metrics:t}){const a=[];for(const[s,n]of Object.entries(t))if(s.startsWith("deepeval_")&&!s.includes("reason")&&typeof n=="number"){const r=s.replace("deepeval_","").split("_").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" "),o=`${s}_reason`;a.push({key:s,label:r,value:n,reason:t[o]})}return a.length===0?null:e.jsx(L,{children:e.jsxs(F,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{icon:"heroicons:academic-cap",className:"text-lg text-success"}),e.jsx("h4",{className:"font-semibold",children:"DeepEval Scores"})]}),e.jsx("div",{className:"space-y-4",children:a.map(({key:s,label:n,value:r,reason:o})=>{const i=r<=1?r*100:r,l=i>=90?"success":i>=70?"warning":"danger";return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:n}),e.jsxs("span",{className:`text-sm font-bold text-${l}`,children:[i.toFixed(0),"%"]})]}),e.jsx("div",{className:"h-2 rounded-full bg-default-200 overflow-hidden",children:e.jsx("div",{className:`h-full bg-${l} rounded-full transition-all`,style:{width:`${i}%`}})}),o&&e.jsx("p",{className:"text-xs text-foreground-500 mt-2 line-clamp-2",children:o})]},s)})})]})})}function Xt({metrics:t}){const a=Object.entries(t);return a.length===0?null:e.jsx(L,{children:e.jsxs(F,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{icon:"heroicons:squares-plus",className:"text-lg text-foreground-500"}),e.jsx("h4",{className:"font-semibold",children:"Other Metrics"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:a.map(([s,n])=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-foreground-400",children:Vt(s)}),e.jsx("p",{className:"text-lg font-semibold",children:Ut(s,n)})]},s))})]})})}function Qt({metrics:t}){if(!t)return e.jsxs("div",{className:"flex h-64 flex-col items-center justify-center text-center",children:[e.jsx(y,{icon:"heroicons:chart-bar",className:"text-5xl text-foreground-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground",children:"No Metrics Available"}),e.jsx("p",{className:"text-sm text-foreground-500 mt-2",children:"Metrics will be available after the simulation completes"})]});const a=t,s={},n={},r={},o={},i={},l={},m=["total_turns","total_tasks","tasks_completed","success_rate","estimated_usd"];for(const[c,x]of Object.entries(a))m.includes(c)?s[c]=x:c.startsWith("latency")||c.startsWith("time_to_first")?n[c]=x:c.startsWith("tokens")||c==="prompt_tokens"||c==="completion_tokens"||c==="total_tokens"?r[c]=x:c.startsWith("tools")?o[c]=x:c.startsWith("deepeval")?i[c]=x:l[c]=x;const p=Object.keys(n).length>0,b=Object.keys(r).length>0,g=Object.keys(o).length>0,u=Object.keys(i).length>0,j=Object.keys(l).length>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Bt,{metrics:s}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[p&&e.jsx(Gt,{metrics:n}),b&&e.jsx(Jt,{metrics:r})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[g&&e.jsx(qt,{metrics:o}),u&&e.jsx(Yt,{metrics:i})]}),j&&e.jsx(Xt,{metrics:l})]})}function Zt(){const t=X(),a=K(c=>c.config),s=K(c=>c.scenarios),n=K(c=>c.selectedForRun),{runnableScenarios:r,groupedScenarios:o}=f.useMemo(()=>{if(!a)return{runnableScenarios:[],groupedScenarios:[]};const c=a.available_scenarios.filter(d=>!se(d.num_tasks)),x=new Map;for(const d of c){const N=d.group;x.has(N)||x.set(N,[]),x.get(N).push(d)}const h=[],v=Array.from(x.keys()).sort((d,N)=>d===null?1:N===null?-1:d.localeCompare(N));for(const d of v)h.push({name:d,scenarios:x.get(d)});return{runnableScenarios:c.map(d=>d.name),groupedScenarios:h}},[a]),i=f.useCallback(c=>{t.getState().actions.toggleScenarioForRun(c)},[t]),l=f.useCallback(()=>{t.getState().actions.selectAllScenariosForRun()},[t]),m=f.useCallback(()=>{t.getState().actions.clearScenariosForRun()},[t]),p=f.useCallback(c=>{const x=o.find(d=>d.name===c);if(!x)return;const h=x.scenarios.map(d=>d.name);h.every(d=>n.includes(d))?t.getState().actions.deselectScenariosForRun(h):t.getState().actions.selectScenariosForRun(h)},[t,o,n]),b=f.useCallback(c=>{const x=o.find(h=>h.name===c);return!x||x.scenarios.length===0?!1:x.scenarios.every(h=>n.includes(h.name))},[o,n]),g=f.useCallback(c=>{const x=o.find(v=>v.name===c);if(!x||x.scenarios.length===0)return!1;const h=x.scenarios.filter(v=>n.includes(v.name)).length;return h>0&&h<x.scenarios.length},[o,n]),u=r.length>0&&r.every(c=>n.includes(c)),j=n.length>0&&!u;return a?r.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center p-6 text-center",children:[e.jsx(y,{icon:"heroicons:document-magnifying-glass",className:"text-4xl text-foreground-300 mb-3"}),e.jsx("p",{className:"text-foreground-500 text-sm",children:"No scenarios available"}),e.jsx("p",{className:"text-xs text-foreground-400 mt-1",children:"Add scenario JSON files to the scenarios directory"})]}):e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-divider",children:[e.jsxs("span",{className:"text-xs text-foreground-500",children:[n.length," of ",r.length," selected"]}),e.jsx(ee,{size:"sm",isSelected:u,isIndeterminate:j,onValueChange:()=>{u?m():l()},children:e.jsx("span",{className:"text-xs",children:"All"})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:o.map(c=>e.jsxs("div",{children:[c.name!==null?e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{size:"sm",variant:"flat",color:"secondary",children:c.name}),e.jsx("span",{className:"text-xs text-foreground-400",children:c.scenarios.length})]}),e.jsx(ee,{size:"sm",isSelected:b(c.name),isIndeterminate:g(c.name),onValueChange:()=>p(c.name),children:e.jsx("span",{className:"text-xs",children:"All"})})]}):o.length>1?e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-foreground-400 uppercase tracking-wide",children:"Ungrouped"}),e.jsx(ee,{size:"sm",isSelected:b(null),isIndeterminate:g(null),onValueChange:()=>p(null),children:e.jsx("span",{className:"text-xs",children:"All"})})]}):null,e.jsx("div",{className:"grid grid-cols-3 gap-2",children:c.scenarios.map(x=>{const h=x.name,v=s[h],d=n.includes(h),N=v?.tasks.length??x.num_tasks;return e.jsxs("button",{onClick:()=>i(h),className:`
                      flex items-center gap-2 px-3 py-2 rounded-lg border transition-colors
                      ${d?"bg-primary-100 dark:bg-primary-900/30 border-primary-300 dark:border-primary-700":"bg-content2 border-transparent hover:bg-content3"}
                    `,children:[e.jsx(ee,{size:"sm",isSelected:d,onValueChange:()=>i(h),onClick:_=>_.stopPropagation()}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:h}),e.jsxs("p",{className:"text-xs text-foreground-500",children:[N," task",N!==1?"s":""]})]})]},h)})})]},c.name??"__ungrouped__"))})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(V,{size:"sm"})})}function en(){const t=X(),a=K(u=>u.config),s=K(u=>u.simulationConfig),n=K(u=>u.selectedPersonas),r=f.useMemo(()=>a?a.available_scenarios.filter(u=>se(u.num_tasks)).map(u=>u.name):[],[a]),o=f.useCallback((u,j)=>{t.getState().actions.setSimulationConfig({[u]:j})},[t]),i=f.useCallback((u,j)=>{const c=j===""?null:parseInt(j,10);(j===""||!isNaN(c)&&c>0)&&o(u,c)},[o]),l=f.useCallback(u=>{t.getState().actions.togglePersonaForRun(u)},[t]),m=f.useCallback(()=>{t.getState().actions.selectPersonasForRun(r)},[t,r]),p=f.useCallback(()=>{t.getState().actions.clearPersonasForRun()},[t]),b=r.length>0&&r.every(u=>n.includes(u)),g=n.length>0&&!b;return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(L,{children:e.jsxs(F,{className:"gap-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-foreground",children:"LLM Models"}),e.jsx(le,{label:"Default Model",placeholder:"e.g., gpt-4o-mini",size:"sm",value:s.default_model||"",onValueChange:u=>o("default_model",u||"gpt-4o-mini"),description:"Model for the agent under test"}),e.jsx(le,{label:"Simulated User Model",placeholder:"Uses default if empty",size:"sm",value:s.sim_user_model_name||"",onValueChange:u=>o("sim_user_model_name",u||null),description:"Model for simulating user behavior"}),e.jsx(le,{label:"Checker Model",placeholder:"Uses default if empty",size:"sm",value:s.checker_model_name||"",onValueChange:u=>o("checker_model_name",u||null),description:"Model for task completion checking"})]})}),e.jsx(L,{children:e.jsxs(F,{className:"gap-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-foreground",children:"Limits"}),e.jsx(le,{label:"Max Turns per Scenario",type:"number",min:1,size:"sm",value:s.max_turns_scenario?.toString()||"",onValueChange:u=>i("max_turns_scenario",u),description:"Maximum conversation turns for entire scenario"}),e.jsx(le,{label:"Max Turns per Task",type:"number",min:1,size:"sm",value:s.max_turns_task?.toString()||"",onValueChange:u=>i("max_turns_task",u),placeholder:"No limit if empty",description:"Maximum turns allowed for each task"})]})}),r.length>0&&e.jsx(L,{children:e.jsxs(F,{className:"gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-foreground",children:"Personas"}),e.jsx("p",{className:"text-xs text-foreground-500 mt-0.5",children:"Select personas for matrix runs"})]}),e.jsx(ee,{size:"sm",isSelected:b,isIndeterminate:g,onValueChange:()=>{b?p():m()},children:e.jsx("span",{className:"text-xs",children:"All"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(u=>{const j=n.includes(u);return e.jsxs("button",{onClick:()=>l(u),className:`
                      flex items-center gap-2 px-3 py-2 rounded-lg border transition-colors
                      ${j?"bg-secondary-100 dark:bg-secondary-900/30 border-secondary-300 dark:border-secondary-700":"bg-content2 border-transparent hover:bg-content3"}
                    `,children:[e.jsx(ee,{size:"sm",isSelected:j,onValueChange:()=>l(u),onClick:c=>c.stopPropagation()}),e.jsx("span",{className:"text-sm font-medium",children:u})]},u)})}),n.length>0&&e.jsxs("p",{className:"text-xs text-foreground-400",children:[n.length," persona",n.length!==1?"s":""," selected"]})]})})]})}function sn(){const t=ue(),{client:a}=Y(),s=X(),n=K(c=>c.selectedForRun),r=K(c=>c.selectedPersonas),o=K(c=>c.isExecuting),[i,l]=f.useState(!1),[m,p]=f.useState(null),b=f.useCallback(()=>{const c=s.getState().config,x=s.getState().selectedForRun;if(!c||x.length===0)return null;const h=c.available_scenarios.filter(d=>x.includes(d.name));return new Set(h.map(d=>d.group)).size===1?h[0]?.group??null:null},[s]),g=f.useCallback(async()=>{const c=s.getState().selectedForRun,x=s.getState().selectedPersonas,h=s.getState().simulationConfig;if(c.length===0)return;const v=b();l(!0),p(null);try{const d=await fetch(`${a.getBaseUrl()}/api/eval/run`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scenario_names:c,personas:x.length>0?x:null,config:h})});if(!d.ok)throw new Error(`Failed to start evaluation: ${d.statusText}`);const _=(await d.json()).run_id;if(!_)throw new Error("Invalid response: missing run_id");const w=x.length>0?x:[null],R=[];for(const S of c)for(const k of w)R.push({id:`${_}_${S}${k?`:${k}`:""}`,scenarioName:S,persona:k,status:"queued",startTime:new Date().toISOString(),endTime:null,turns:[],tasks:[],metrics:null,error:null});const $={id:_,timestamp:new Date().toISOString(),version:"current",status:"running",config:h,group:v,scenarioRuns:R,totalScenarios:R.length,completedScenarios:0,failedScenarios:0,totalTokens:0,totalCostUsd:0,overallSuccessRate:0};s.getState().actions.addSimulationRun($),s.getState().actions.startExecution(_,c);const I=new EventSource(`${a.getBaseUrl()}/api/eval/progress/${_}`);I.onmessage=S=>{try{const k=JSON.parse(S.data);s.getState().actions.handleProgressUpdate(k);const E=s.getState().simulationRuns.find(D=>D.id===_);if(E){let D=E.scenarioRuns.findIndex(T=>T.id===k.scenario_run_id);if(D===-1&&(D=E.scenarioRuns.findIndex(T=>T.scenarioName===k.scenario_name&&(T.persona??null)===(k.persona??null)&&!T.id.startsWith("sr_"))),D!==-1){const T=[...E.scenarioRuns],C={...T[D]};k.scenario_run_id&&C.id!==k.scenario_run_id&&(C.id=k.scenario_run_id),k.type==="status"?C.status=k.status:k.type==="turn"?(C.status="running",C.turns=[...C.turns,{turn_index:k.turn_index,task_index:k.task_index,user_message:k.user_message,assistant_message:k.assistant_message,tool_calls:k.tool_calls,task_completed:k.task_completed,task_completed_reason:k.task_completed_reason,token_usage:null,latency_ms:null,checkers:k.checkers,checker_mode:k.checker_mode}]):k.type==="response_chunk"?(C.responseChunks||(C.responseChunks=[]),C.responseChunks=[...C.responseChunks,{turn_index:k.turn_index,task_index:k.task_index,chunk_index:C.responseChunks.length,chunk_type:k.chunk_type,chunk_data:k.chunk_data,timestamp:Date.now()}]):k.type==="complete"?(C.status=k.status,C.endTime=new Date().toISOString()):k.type==="error"&&(C.status="failed",C.error=k.error,C.endTime=new Date().toISOString()),T[D]=C;const A=T.filter(z=>z.status==="completed").length,O=T.filter(z=>z.status==="failed"||z.status==="timeout").length,P=A+O===T.length;s.getState().actions.updateSimulationRun(_,{scenarioRuns:T,status:P?O>0?"failed":"completed":"running",completedScenarios:A,failedScenarios:O})}}(k.type==="complete"||k.type==="error")&&yt(s.getState()).running===0&&I.close()}catch(k){console.error("Failed to parse progress update:",k)}},I.onerror=()=>{console.error("SSE connection error"),I.close()},s.getState().actions.clearScenariosForRun(),s.getState().actions.clearPersonasForRun(),t(`/runs/${_}`)}catch(d){console.error("Failed to start evaluation:",d),p(d instanceof Error?d.message:"Failed to start run"),l(!1)}},[a,s,t,b]),u=n.length*Math.max(r.length,1),j=n.length>0&&!o&&!i;return e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-1/2 border-r border-divider flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-divider",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Select Scenarios"}),e.jsx("p",{className:"text-sm text-foreground-500 mt-0.5",children:"Choose scenarios to run"})]}),e.jsx(Zt,{})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-3 border-b border-divider",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Configuration"}),e.jsx("p",{className:"text-sm text-foreground-500 mt-0.5",children:"Configure the simulation parameters"})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsx(en,{})}),e.jsxs("div",{className:"px-6 py-4 border-t border-divider",children:[m&&e.jsx("div",{className:"mb-3 p-3 bg-danger-50 dark:bg-danger-900/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-danger",children:m})}),e.jsx(W,{color:"primary",size:"lg",className:"w-full",isDisabled:!j,isLoading:i,onPress:g,startContent:!i&&e.jsx(y,{icon:"heroicons:play",className:"text-lg"}),children:i?"Starting...":n.length>0?r.length>1?`Start ${u} Runs (${n.length} scenarios  ${r.length} personas)`:`Start Run (${n.length} scenario${n.length!==1?"s":""})`:"Select scenarios to run"})]})]})]})}function tn(){const{client:t}=Y(),a=X(),s=K(g=>g.config),n=K(g=>g.scenarios),r=f.useRef(!1),[o,i]=f.useState(null),{groupedScenarios:l,allScenarioNames:m}=f.useMemo(()=>{if(!s)return{groupedScenarios:[],allScenarioNames:[]};const g=s.available_scenarios.filter(x=>!se(x.num_tasks)),u=new Map;for(const x of g){const h=x.group;u.has(h)||u.set(h,[]),u.get(h).push(x)}const j=[],c=Array.from(u.keys()).sort((x,h)=>x===null?1:h===null?-1:x.localeCompare(h));for(const x of c)j.push({name:x,scenarios:u.get(x)});return{groupedScenarios:j,allScenarioNames:g.map(x=>x.name)}},[s]);f.useEffect(()=>{if(!s||r.current)return;r.current=!0;async function g(){const{setScenario:u}=a.getState().actions;for(const j of s.available_scenarios)try{const c=await t.makeRequest(`/api/eval/scenarios/${j.name}`);u(j.name,c)}catch(c){console.error(`Failed to load scenario ${j.name}:`,c)}}g()},[t,s,a]),f.useEffect(()=>{!o&&m.length>0&&i(m[0])},[o,m]);const p=o?n[o]:null,b=s?.available_scenarios.find(g=>g.name===o);return s?m.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center p-6 text-center",children:[e.jsx(y,{icon:"heroicons:document-magnifying-glass",className:"text-6xl text-foreground-300 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"No Scenarios Found"}),e.jsx("p",{className:"text-foreground-500 max-w-md",children:"Add scenario JSON files to the scenarios directory to get started."})]}):e.jsxs("div",{className:"flex h-full",children:[e.jsx("aside",{className:"w-72 flex-shrink-0 border-r border-divider overflow-y-auto",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-foreground-500 uppercase tracking-wide mb-3",children:["Scenarios (",m.length,")"]}),e.jsx("div",{className:"space-y-4",children:l.map(g=>e.jsxs("div",{children:[g.name!==null&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(M,{size:"sm",variant:"flat",color:"secondary",children:g.name}),e.jsx("span",{className:"text-xs text-foreground-400",children:g.scenarios.length})]}),e.jsx("div",{className:"space-y-1",children:g.scenarios.map(u=>e.jsx(L,{isPressable:!0,onPress:()=>i(u.name),className:`w-full ${o===u.name?"border-2 border-primary":""}`,children:e.jsxs(F,{className:"p-3",children:[e.jsx("p",{className:"font-medium truncate",children:u.name}),e.jsxs("p",{className:"text-xs text-foreground-400",children:[u.num_tasks," task",u.num_tasks!==1?"s":""]})]})},u.name))})]},g.name??"__ungrouped__"))})]})}),e.jsx("main",{className:"flex-1 min-h-0 overflow-auto",children:p?e.jsx(nn,{scenario:p,group:b?.group}):o?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(V,{size:"sm"})}):e.jsx("div",{className:"flex h-full items-center justify-center text-foreground-500",children:"Select a scenario to view details"})})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(V,{size:"lg"})})}function nn({scenario:t,group:a}){return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:t.name}),a&&e.jsx(M,{size:"sm",variant:"flat",color:"secondary",children:a})]}),e.jsxs("p",{className:"text-foreground-500",children:[t.tasks.length," task",t.tasks.length!==1?"s":""]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Tasks"}),t.tasks.map((s,n)=>e.jsx(L,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-sm font-semibold text-primary",children:n+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-foreground mb-2",children:s.task}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.checkers.map((r,o)=>e.jsx(M,{size:"sm",variant:"flat",children:r.type},o)),s.checker_mode&&s.checker_mode!=="all"&&e.jsxs(M,{size:"sm",variant:"bordered",color:"warning",children:["mode: ",s.checker_mode]})]})]})]})})},n))]})]})}function an({isOpen:t,onClose:a,task:s,taskIndex:n,scenarioName:r}){const{client:o}=Y(),i=K(_=>_.config),l=K(_=>_.simulationConfig),[m,p]=f.useState(l.persona),[b,g]=f.useState(!1),[u,j]=f.useState(null),[c,x]=f.useState(null),h=f.useMemo(()=>i?i.available_scenarios.filter(_=>se(_.num_tasks)).map(_=>_.name):[],[i]),v=f.useCallback(async()=>{if(s){g(!0),x(null),j(null);try{const _=await fetch(`${o.getBaseUrl()}/api/eval/test-persona`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task:s.task,persona:m,scenario_name:r,task_index:n,model:l.sim_user_model_name||l.default_model})});if(!_.ok)throw new Error(`Failed to test persona: ${_.statusText}`);const w=await _.json();j({message:w.message,persona:w.persona||m||"Default",model:w.model||l.sim_user_model_name||l.default_model})}catch(_){x(_ instanceof Error?_.message:"An error occurred")}finally{g(!1)}}},[o,s,m,r,n,l]),d=f.useCallback(()=>{j(null),x(null),a()},[a]),N=f.useCallback(_=>{if(_==="all")return;const w=Array.from(_)[0]||null;p(w===""?null:w)},[]);return s?e.jsx(Ds,{isOpen:t,onOpenChange:d,size:"2xl",children:e.jsxs(Is,{children:[e.jsxs(at,{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-foreground",children:"Test Task with Persona"}),e.jsx("span",{className:"text-sm font-normal text-foreground-500",children:"See how a simulated user would ask this task"})]}),e.jsx(Fs,{className:"pb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{className:"bg-default-50",children:e.jsxs(F,{className:"p-4",children:[e.jsxs("p",{className:"text-xs text-foreground-500 mb-1",children:["Task ",n+1]}),e.jsx("p",{className:"text-foreground",children:s.task}),s.checkers&&s.checkers.length>0&&e.jsxs("p",{className:"text-sm text-foreground-500 mt-2",children:[e.jsx("span",{className:"font-medium",children:"Checkers: "}),s.checkers.map(_=>_.type).join(", ")," (",s.checker_mode||"all",")"]})]})}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsx(et,{label:"Persona",placeholder:"Select a persona (optional)",size:"sm",className:"flex-1",selectedKeys:m?new Set([m]):new Set,onSelectionChange:N,description:"Choose a persona for the simulated user",children:h.map(_=>e.jsx(Ze,{children:_},_))}),e.jsx(W,{color:"primary",onPress:v,isLoading:b,startContent:!b&&e.jsx(y,{icon:"heroicons:play"}),children:"Generate"})]}),b&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(V,{size:"lg"})}),c&&e.jsx(L,{className:"bg-danger-50 dark:bg-danger-900/20",children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(y,{icon:"heroicons:exclamation-circle",className:"text-danger text-xl flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-danger",children:"Error"}),e.jsx("p",{className:"text-sm text-danger-600 dark:text-danger-400",children:c})]})]})})}),u&&e.jsx(L,{className:"bg-primary-50 dark:bg-primary-900/20",children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center flex-shrink-0",children:e.jsx(y,{icon:"heroicons:user",className:"text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Simulated User"}),u.persona&&e.jsxs("span",{className:"text-xs text-foreground-500",children:["(",u.persona,")"]})]}),e.jsx("p",{className:"text-foreground whitespace-pre-wrap",children:u.message}),e.jsxs("p",{className:"text-xs text-foreground-400 mt-3",children:["Model: ",u.model]})]})]})})})]})})]})}):null}function rn(){const{scenarioName:t}=Qe(),a=ue(),s=X(),n=K(S=>S.selectedScenarioName),r=t?decodeURIComponent(t):n,o=K(S=>S.scenarios),i=K(S=>S.runHistory),l=r?o[r]:null,m=r?i[r]:null,[p,b]=f.useState(null),[g,u]=f.useState(null),[j,c]=f.useState(null),[x,h]=f.useState(null),v=f.useCallback(()=>{a("/scenarios")},[a]),d=f.useCallback(()=>{r&&a(`/new?scenario=${encodeURIComponent(r)}`)},[a,r]),N=(S,k)=>{b(S),u({...k})},_=()=>{p!==null&&g&&r&&(s.getState().actions.updateScenarioTask(r,p,g),b(null),u(null))},w=()=>{b(null),u(null)},R=(S,k)=>{c(S),h(k)},$=()=>{c(null),h(null)};if(!r||!l)return e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("p",{className:"text-foreground-500",children:"No scenario selected"})});const I=m?.[0];return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"border-b border-divider px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(W,{isIconOnly:!0,variant:"light",onPress:v,"aria-label":"Go back",children:e.jsx(y,{icon:"heroicons:arrow-left",className:"text-xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-foreground",children:l.name}),e.jsxs("p",{className:"text-sm text-foreground-500",children:[l.tasks.length," task",l.tasks.length!==1?"s":""]})]}),e.jsx(W,{color:"primary",startContent:e.jsx(y,{icon:"heroicons:play"}),onPress:d,children:"Run Scenario"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(L,{className:"flex-1",children:e.jsxs(F,{className:"flex flex-row items-center gap-3 p-4",children:[e.jsx("div",{className:"rounded-lg bg-primary-100 dark:bg-primary-900/30 p-2",children:e.jsx(y,{icon:"heroicons:clipboard-document-list",className:"text-xl text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-foreground-500",children:"Tasks"}),e.jsx("p",{className:"text-lg font-semibold",children:l.tasks.length})]})]})}),e.jsx(L,{className:"flex-1",children:e.jsxs(F,{className:"flex flex-row items-center gap-3 p-4",children:[e.jsx("div",{className:"rounded-lg bg-success-100 dark:bg-success-900/30 p-2",children:e.jsx(y,{icon:"heroicons:clock",className:"text-xl text-success"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-foreground-500",children:"Last Run"}),e.jsx("p",{className:"text-lg font-semibold",children:I?new Date(I.timestamp).toLocaleDateString():"Never"})]})]})}),e.jsx(L,{className:"flex-1",children:e.jsxs(F,{className:"flex flex-row items-center gap-3 p-4",children:[e.jsx("div",{className:"rounded-lg bg-warning-100 dark:bg-warning-900/30 p-2",children:e.jsx(y,{icon:"heroicons:chart-bar",className:"text-xl text-warning"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-foreground-500",children:"Total Runs"}),e.jsx("p",{className:"text-lg font-semibold",children:m?.length??0})]})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Tasks"}),e.jsx("div",{className:"space-y-4",children:l.tasks.map((S,k)=>e.jsx(L,{children:e.jsx(F,{className:"p-4",children:p===k?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-foreground-500",children:["Task ",k+1]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(W,{size:"sm",variant:"flat",onPress:w,children:"Cancel"}),e.jsx(W,{size:"sm",color:"primary",onPress:_,children:"Save"})]})]}),e.jsx(Ls,{label:"Task Description",value:g?.task??"",onValueChange:E=>u(D=>D?{...D,task:E}:null),minRows:2}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-foreground-500 mb-1",children:"Checkers (read-only)"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:g?.checkers?.map((E,D)=>e.jsx(M,{size:"sm",variant:"flat",children:E.type},D))??e.jsx("span",{className:"text-foreground-400 italic",children:"None"})}),g?.checker_mode&&e.jsxs("p",{className:"text-xs text-foreground-400 mt-1",children:["Mode: ",g.checker_mode]})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs(M,{size:"sm",variant:"flat",color:"primary",children:["Task ",k+1]})}),e.jsx("p",{className:"text-foreground",children:S.task})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Le,{content:"Test with Persona",children:e.jsx(W,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>R(k,S),"aria-label":"Test with persona",children:e.jsx(y,{icon:"heroicons:user-circle"})})}),e.jsx(Le,{content:"Edit task",children:e.jsx(W,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>N(k,S),"aria-label":"Edit task",children:e.jsx(y,{icon:"heroicons:pencil"})})})]})]}),e.jsx(Ms,{className:"my-3"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-foreground-500 mb-2",children:"Checkers"}),S.checkers&&S.checkers.length>0?e.jsxs("div",{className:"space-y-2",children:[S.checkers.map((E,D)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{size:"sm",variant:"flat",color:"primary",children:E.type}),e.jsx("span",{className:"text-foreground-400 text-xs",children:Object.entries(E).filter(([T])=>T!=="type").map(([T,C])=>`${T}: ${JSON.stringify(C)}`).join(", ")})]},D)),S.checker_mode&&e.jsxs("p",{className:"text-xs text-foreground-400",children:["Mode: ",S.checker_mode]})]}):e.jsx("p",{className:"text-foreground-400 italic",children:"No checkers configured"})]})]})})},k))})]}),m&&m.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Runs"}),e.jsx("div",{className:"space-y-2",children:m.slice(0,5).map(S=>e.jsx(L,{isPressable:!0,onPress:()=>{a(`/runs/${S.runId}`)},children:e.jsxs(F,{className:"flex flex-row items-center justify-between p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{size:"sm",color:S.status==="completed"?"success":S.status==="failed"?"danger":S.status==="timeout"?"warning":"default",variant:"flat",children:S.status}),e.jsx("span",{className:"text-sm text-foreground",children:new Date(S.timestamp).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-foreground-500",children:[e.jsxs("span",{children:[S.execution.turns.length," turns"]}),e.jsx(y,{icon:"heroicons:chevron-right"})]})]})},S.runId))})]})]})}),e.jsx(an,{isOpen:j!==null,onClose:$,task:x,taskIndex:j??0,scenarioName:r})]})}function on(){const{client:t}=Y(),a=f.useRef(!1),[s,n]=f.useState([]),[r,o]=f.useState(!0),[i,l]=f.useState(null),[m,p]=f.useState(null);f.useEffect(()=>{if(a.current)return;a.current=!0;async function g(){try{o(!0);const u=await fetch(`${t.getBaseUrl()}/api/eval/personas`);if(!u.ok)throw new Error(`Failed to load personas: ${u.statusText}`);const j=await u.json();n(j.personas),l(null)}catch(u){console.error("Failed to load personas:",u),l(u instanceof Error?u.message:"Failed to load personas")}finally{o(!1)}}g()},[t]),f.useEffect(()=>{!m&&s.length>0&&p(s[0].name)},[m,s]);const b=s.find(g=>g.name===m);return r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(V,{size:"lg"})}):i?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center p-6 text-center",children:[e.jsx(y,{icon:"heroicons:exclamation-triangle",className:"text-6xl text-danger mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Error Loading Personas"}),e.jsx("p",{className:"text-foreground-500 max-w-md",children:i})]}):s.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center p-6 text-center",children:[e.jsx(y,{icon:"heroicons:user-group",className:"text-6xl text-foreground-300 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"No Personas Found"}),e.jsxs("p",{className:"text-foreground-500 max-w-md",children:["Create a ",e.jsx("code",{className:"bg-content2 px-1.5 py-0.5 rounded text-sm",children:"personas.json"})," file in your scenarios directory to define user personas for simulations."]})]}):e.jsxs("div",{className:"flex h-full",children:[e.jsx("aside",{className:"w-72 flex-shrink-0 border-r border-divider overflow-y-auto",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-foreground-500 uppercase tracking-wide mb-3",children:["Personas (",s.length,")"]}),e.jsx("div",{className:"space-y-1",children:s.map(g=>e.jsx(L,{isPressable:!0,onPress:()=>p(g.name),className:`w-full ${m===g.name?"border-2 border-primary":""}`,children:e.jsx(F,{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-secondary/20 flex items-center justify-center flex-shrink-0",children:e.jsx(y,{icon:"heroicons:user",className:"text-secondary text-sm"})}),e.jsx("p",{className:"font-medium truncate",children:g.name})]})})},g.name))})]})}),e.jsx("main",{className:"flex-1 min-h-0 overflow-auto",children:b?e.jsx(ln,{persona:b}):e.jsx("div",{className:"flex h-full items-center justify-center text-foreground-500",children:"Select a persona to view details"})})]})}function ln({persona:t}){return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-secondary/20 flex items-center justify-center",children:e.jsx(y,{icon:"heroicons:user",className:"text-secondary text-2xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:t.name}),e.jsx("p",{className:"text-foreground-500",children:"Persona definition"})]})]})}),e.jsx(L,{className:"mb-4",children:e.jsxs(F,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground-500 uppercase tracking-wide mb-3",children:"Description"}),e.jsx("p",{className:"text-foreground-700 whitespace-pre-wrap leading-relaxed",children:t.description})]})}),e.jsx(L,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(y,{icon:"heroicons:information-circle",className:"text-foreground-400 text-xl flex-shrink-0 mt-0.5"}),e.jsx("div",{children:e.jsx("p",{className:"text-foreground-600",children:"This persona can be selected when running scenarios to define the simulated user's behavior and personality."})})]})})})]})}function cn(){return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-6",children:[e.jsx(y,{icon:"heroicons:beaker",className:"text-6xl text-foreground-300 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Playground"}),e.jsx("p",{className:"text-foreground-500 max-w-md",children:"Experiment with scenarios and test agent behavior interactively. Run individual tasks and see results in real-time."}),e.jsx("p",{className:"text-sm text-foreground-400 mt-4",children:"Coming soon"})]})}const dn=[{path:"/",element:e.jsx(Ct,{}),children:[{index:!0,element:e.jsx(As,{to:"/runs",replace:!0})},{path:"runs",element:e.jsx(Ft,{})},{path:"runs/:runId",element:e.jsx(At,{})},{path:"new",element:e.jsx(sn,{})},{path:"scenarios",element:e.jsx(tn,{})},{path:"scenarios/:scenarioName",element:e.jsx(rn,{})},{path:"personas",element:e.jsx(on,{})},{path:"playground",element:e.jsx(cn,{})}]}],un=new URLSearchParams(window.location.search).has("mock");function mn(){const{client:t}=Y(),a=X(),s=K(i=>i.isConfigLoading),n=K(i=>i.configError),r=f.useRef(!1),o=Ks(dn);return f.useEffect(()=>{if(r.current)return;if(r.current=!0,un){a.getState().actions.loadMockData();return}async function i(){const{setConfigLoading:l,setConfig:m,setConfigError:p}=a.getState().actions;l(!0);try{const b=await t.makeRequest("/api/eval/config");m(b)}catch(b){p(b instanceof Error?b.message:"Failed to load config")}}i()},[t,a]),s?e.jsx("div",{className:"flex h-full items-center justify-center bg-background",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(V,{size:"lg"}),e.jsx("p",{className:"text-foreground-500",children:"Loading evaluation configuration..."})]})}):n?e.jsx("div",{className:"flex h-full items-center justify-center bg-background",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[e.jsx("div",{className:"text-6xl",children:"!"}),e.jsx("h1",{className:"text-xl font-semibold text-danger",children:"Failed to Connect"}),e.jsx("p",{className:"max-w-md text-foreground-500",children:"Could not connect to the evaluation API. Make sure the EvalAPI server is running."}),e.jsx("p",{className:"text-sm text-foreground-400",children:n}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 rounded-lg bg-primary px-4 py-2 text-white hover:bg-primary-600",children:"Retry"})]})}):o}const xn="";Es(["heroicons:check","heroicons:x-mark","heroicons:play","heroicons:stop","heroicons:arrow-path","heroicons:sun","heroicons:moon","heroicons:chevron-down","heroicons:chevron-right","heroicons:document-text","heroicons:clipboard","heroicons:trash","heroicons:pencil","heroicons:eye","heroicons:chart-bar","heroicons:chat-bubble-left-right","heroicons:clock","heroicons:currency-dollar","heroicons:cpu-chip"]);Os.createRoot(document.getElementById("root")).render(e.jsx(f.StrictMode,{children:e.jsx(Ws,{children:e.jsx(zs,{baseUrl:xn,children:e.jsx(Hs,{children:e.jsx(St,{children:e.jsx(Us,{children:e.jsx(mn,{})})})})})})}));
