import{aR as Gr,u as Jr,r as hr,j as k,D as Wr,d as gr,I as qr,m as Yr,e as Kr,f as Lr,g as Qr,aS as Vr}from"./index-BT75Q8kN.js";import{m as Xr}from"./chunk-IGSAU2ZA-BHMqxcaJ.js";var T=Uint8Array,P=Uint16Array,dr=Int32Array,lr=new T([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),sr=new T([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),mr=new T([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_r=function(r,e){for(var a=new P(31),n=0;n<31;++n)a[n]=e+=1<<r[n-1];for(var t=new dr(a[30]),n=1;n<30;++n)for(var o=a[n];o<a[n+1];++o)t[o]=o-a[n]<<5|n;return{b:a,r:t}},Dr=_r(lr,2),Rr=Dr.b,pr=Dr.r;Rr[28]=258,pr[258]=28;var zr=_r(sr,0),Zr=zr.b,jr=zr.r,Cr=new P(32768);for(var y=0;y<32768;++y){var Q=(y&43690)>>1|(y&21845)<<1;Q=(Q&52428)>>2|(Q&13107)<<2,Q=(Q&61680)>>4|(Q&3855)<<4,Cr[y]=((Q&65280)>>8|(Q&255)<<8)>>1}var q=function(r,e,a){for(var n=r.length,t=0,o=new P(e);t<n;++t)r[t]&&++o[r[t]-1];var v=new P(e);for(t=1;t<e;++t)v[t]=v[t-1]+o[t-1]<<1;var s;if(a){s=new P(1<<e);var h=15-e;for(t=0;t<n;++t)if(r[t])for(var l=t<<4|r[t],f=e-r[t],i=v[r[t]-1]++<<f,u=i|(1<<f)-1;i<=u;++i)s[Cr[i]>>h]=l}else for(s=new P(n),t=0;t<n;++t)r[t]&&(s[t]=Cr[v[r[t]-1]++]>>15-r[t]);return s},V=new T(288);for(var y=0;y<144;++y)V[y]=8;for(var y=144;y<256;++y)V[y]=9;for(var y=256;y<280;++y)V[y]=7;for(var y=280;y<288;++y)V[y]=8;var fr=new T(32);for(var y=0;y<32;++y)fr[y]=5;var re=q(V,9,0),ee=q(V,9,1),ae=q(fr,5,0),ne=q(fr,5,1),wr=function(r){for(var e=r[0],a=1;a<r.length;++a)r[a]>e&&(e=r[a]);return e},J=function(r,e,a){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&a},xr=function(r,e){var a=e/8|0;return(r[a]|r[a+1]<<8|r[a+2]<<16)>>(e&7)},Mr=function(r){return(r+7)/8|0},cr=function(r,e,a){return(e==null||e<0)&&(e=0),(a==null||a>r.length)&&(a=r.length),new T(r.subarray(e,a))},te=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],B=function(r,e,a){var n=new Error(e||te[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,B),!a)throw n;return n},oe=function(r,e,a,n){var t=r.length,o=0;if(!t||e.f&&!e.l)return a||new T(0);var v=!a,s=v||e.i!=2,h=e.i;v&&(a=new T(t*3));var l=function(ar){var nr=a.length;if(ar>nr){var rr=new T(Math.max(nr*2,ar));rr.set(a),a=rr}},f=e.f||0,i=e.p||0,u=e.b||0,g=e.l,b=e.d,x=e.m,S=e.n,G=t*8;do{if(!g){f=J(r,i,1);var R=J(r,i+1,3);if(i+=3,R)if(R==1)g=ee,b=ne,x=9,S=5;else if(R==2){var N=J(r,i,31)+257,d=J(r,i+10,15)+4,w=N+J(r,i+5,31)+1;i+=14;for(var c=new T(w),M=new T(19),C=0;C<d;++C)M[mr[C]]=J(r,i+C*3,7);i+=d*3;for(var O=wr(M),L=(1<<O)-1,z=q(M,O,1),C=0;C<w;){var _=z[J(r,i,L)];i+=_&15;var A=_>>4;if(A<16)c[C++]=A;else{var j=0,m=0;for(A==16?(m=3+J(r,i,3),i+=2,j=c[C-1]):A==17?(m=3+J(r,i,7),i+=3):A==18&&(m=11+J(r,i,127),i+=7);m--;)c[C++]=j}}var D=c.subarray(0,N),E=c.subarray(N);x=wr(D),S=wr(E),g=q(D,x,1),b=q(E,S,1)}else B(1);else{var A=Mr(i)+4,I=r[A-4]|r[A-3]<<8,F=A+I;if(F>t){h&&B(0);break}s&&l(u+I),a.set(r.subarray(A,F),u),e.b=u+=I,e.p=i=F*8,e.f=f;continue}if(i>G){h&&B(0);break}}s&&l(u+131072);for(var er=(1<<x)-1,$=(1<<S)-1,Y=i;;Y=i){var j=g[xr(r,i)&er],U=j>>4;if(i+=j&15,i>G){h&&B(0);break}if(j||B(2),U<256)a[u++]=U;else if(U==256){Y=i,g=null;break}else{var H=U-254;if(U>264){var C=U-257,p=lr[C];H=J(r,i,(1<<p)-1)+Rr[C],i+=p}var W=b[xr(r,i)&$],X=W>>4;W||B(3),i+=W&15;var E=Zr[X];if(X>3){var p=sr[X];E+=xr(r,i)&(1<<p)-1,i+=p}if(i>G){h&&B(0);break}s&&l(u+131072);var Z=u+H;if(u<E){var ir=o-E,vr=Math.min(E,Z);for(ir+u<0&&B(3);u<vr;++u)a[u]=n[ir+u]}for(;u<Z;++u)a[u]=a[u-E]}}e.l=g,e.p=Y,e.b=u,e.f=f,g&&(f=1,e.m=x,e.d=b,e.n=S)}while(!f);return u!=a.length&&v?cr(a,0,u):a.subarray(0,u)},K=function(r,e,a){a<<=e&7;var n=e/8|0;r[n]|=a,r[n+1]|=a>>8},tr=function(r,e,a){a<<=e&7;var n=e/8|0;r[n]|=a,r[n+1]|=a>>8,r[n+2]|=a>>16},yr=function(r,e){for(var a=[],n=0;n<r.length;++n)r[n]&&a.push({s:n,f:r[n]});var t=a.length,o=a.slice();if(!t)return{t:Hr,l:0};if(t==1){var v=new T(a[0].s+1);return v[a[0].s]=1,{t:v,l:1}}a.sort(function(F,N){return F.f-N.f}),a.push({s:-1,f:25001});var s=a[0],h=a[1],l=0,f=1,i=2;for(a[0]={s:-1,f:s.f+h.f,l:s,r:h};f!=t-1;)s=a[a[l].f<a[i].f?l++:i++],h=a[l!=f&&a[l].f<a[i].f?l++:i++],a[f++]={s:-1,f:s.f+h.f,l:s,r:h};for(var u=o[0].s,n=1;n<t;++n)o[n].s>u&&(u=o[n].s);var g=new P(u+1),b=Tr(a[f-1],g,0);if(b>e){var n=0,x=0,S=b-e,G=1<<S;for(o.sort(function(N,d){return g[d.s]-g[N.s]||N.f-d.f});n<t;++n){var R=o[n].s;if(g[R]>e)x+=G-(1<<b-g[R]),g[R]=e;else break}for(x>>=S;x>0;){var A=o[n].s;g[A]<e?x-=1<<e-g[A]++-1:++n}for(;n>=0&&x;--n){var I=o[n].s;g[I]==e&&(--g[I],++x)}b=e}return{t:new T(g),l:b}},Tr=function(r,e,a){return r.s==-1?Math.max(Tr(r.l,e,a+1),Tr(r.r,e,a+1)):e[r.s]=a},Er=function(r){for(var e=r.length;e&&!r[--e];);for(var a=new P(++e),n=0,t=r[0],o=1,v=function(h){a[n++]=h},s=1;s<=e;++s)if(r[s]==t&&s!=e)++o;else{if(!t&&o>2){for(;o>138;o-=138)v(32754);o>2&&(v(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(v(t),--o;o>6;o-=6)v(8304);o>2&&(v(o-3<<5|8208),o=0)}for(;o--;)v(t);o=1,t=r[s]}return{c:a.subarray(0,n),n:e}},or=function(r,e){for(var a=0,n=0;n<e.length;++n)a+=r[n]*e[n];return a},Ur=function(r,e,a){var n=a.length,t=Mr(e+2);r[t]=n&255,r[t+1]=n>>8,r[t+2]=r[t]^255,r[t+3]=r[t+1]^255;for(var o=0;o<n;++o)r[t+o+4]=a[o];return(t+4+n)*8},Fr=function(r,e,a,n,t,o,v,s,h,l,f){K(e,f++,a),++t[256];for(var i=yr(t,15),u=i.t,g=i.l,b=yr(o,15),x=b.t,S=b.l,G=Er(u),R=G.c,A=G.n,I=Er(x),F=I.c,N=I.n,d=new P(19),w=0;w<R.length;++w)++d[R[w]&31];for(var w=0;w<F.length;++w)++d[F[w]&31];for(var c=yr(d,7),M=c.t,C=c.l,O=19;O>4&&!M[mr[O-1]];--O);var L=l+5<<3,z=or(t,V)+or(o,fr)+v,_=or(t,u)+or(o,x)+v+14+3*O+or(d,M)+2*d[16]+3*d[17]+7*d[18];if(h>=0&&L<=z&&L<=_)return Ur(e,f,r.subarray(h,h+l));var j,m,D,E;if(K(e,f,1+(_<z)),f+=2,_<z){j=q(u,g,0),m=u,D=q(x,S,0),E=x;var er=q(M,C,0);K(e,f,A-257),K(e,f+5,N-1),K(e,f+10,O-4),f+=14;for(var w=0;w<O;++w)K(e,f+3*w,M[mr[w]]);f+=3*O;for(var $=[R,F],Y=0;Y<2;++Y)for(var U=$[Y],w=0;w<U.length;++w){var H=U[w]&31;K(e,f,er[H]),f+=M[H],H>15&&(K(e,f,U[w]>>5&127),f+=U[w]>>12)}}else j=re,m=V,D=ae,E=fr;for(var w=0;w<s;++w){var p=n[w];if(p>255){var H=p>>18&31;tr(e,f,j[H+257]),f+=m[H+257],H>7&&(K(e,f,p>>23&31),f+=lr[H]);var W=p&31;tr(e,f,D[W]),f+=E[W],W>3&&(tr(e,f,p>>5&8191),f+=sr[W])}else tr(e,f,j[p]),f+=m[p]}return tr(e,f,j[256]),f+m[256]},fe=new dr([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Hr=new T(0),ie=function(r,e,a,n,t,o){var v=o.z||r.length,s=new T(n+v+5*(1+Math.ceil(v/7e3))+t),h=s.subarray(n,s.length-t),l=o.l,f=(o.r||0)&7;if(e){f&&(h[0]=o.r>>3);for(var i=fe[e-1],u=i>>13,g=i&8191,b=(1<<a)-1,x=o.p||new P(32768),S=o.h||new P(b+1),G=Math.ceil(a/3),R=2*G,A=function(ur){return(r[ur]^r[ur+1]<<G^r[ur+2]<<R)&b},I=new dr(25e3),F=new P(288),N=new P(32),d=0,w=0,c=o.i||0,M=0,C=o.w||0,O=0;c+2<v;++c){var L=A(c),z=c&32767,_=S[L];if(x[z]=_,S[L]=z,C<=c){var j=v-c;if((d>7e3||M>24576)&&(j>423||!l)){f=Fr(r,h,0,I,F,N,w,M,O,c-O,f),M=d=w=0,O=c;for(var m=0;m<286;++m)F[m]=0;for(var m=0;m<30;++m)N[m]=0}var D=2,E=0,er=g,$=z-_&32767;if(j>2&&L==A(c-$))for(var Y=Math.min(u,j)-1,U=Math.min(32767,c),H=Math.min(258,j);$<=U&&--er&&z!=_;){if(r[c+D]==r[c+D-$]){for(var p=0;p<H&&r[c+p]==r[c+p-$];++p);if(p>D){if(D=p,E=$,p>Y)break;for(var W=Math.min($,p-2),X=0,m=0;m<W;++m){var Z=c-$+m&32767,ir=x[Z],vr=Z-ir&32767;vr>X&&(X=vr,_=Z)}}}z=_,_=x[z],$+=z-_&32767}if(E){I[M++]=268435456|pr[D]<<18|jr[E];var ar=pr[D]&31,nr=jr[E]&31;w+=lr[ar]+sr[nr],++F[257+ar],++N[nr],C=c+D,++d}else I[M++]=r[c],++F[r[c]]}}for(c=Math.max(c,C);c<v;++c)I[M++]=r[c],++F[r[c]];f=Fr(r,h,l,I,F,N,w,M,O,c-O,f),l||(o.r=f&7|h[f/8|0]<<3,f-=7,o.h=S,o.p=x,o.i=c,o.w=C)}else{for(var c=o.w||0;c<v+l;c+=65535){var rr=c+65535;rr>=v&&(h[f/8|0]=l,rr=v),f=Ur(h,f+1,r.subarray(c,rr))}o.i=v}return cr(s,0,n+Mr(f)+t)},Pr=function(){var r=1,e=0;return{p:function(a){for(var n=r,t=e,o=a.length|0,v=0;v!=o;){for(var s=Math.min(v+2655,o);v<s;++v)t+=n+=a[v];n=(n&65535)+15*(n>>16),t=(t&65535)+15*(t>>16)}r=n,e=t},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},ve=function(r,e,a,n,t){if(!t&&(t={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),v=new T(o.length+r.length);v.set(o),v.set(r,o.length),r=v,t.w=o.length}return ie(r,e.level==null?6:e.level,e.mem==null?t.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,a,n,t)},$r=function(r,e,a){for(;a;++e)r[e]=a,a>>>=8},le=function(r,e){var a=e.level,n=a==0?0:a<6?1:a==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var t=Pr();t.p(e.dictionary),$r(r,2,t.d())}},se=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&B(6,"invalid zlib data"),(r[1]>>5&1)==1&&B(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function ce(r,e){e||(e={});var a=Pr();a.p(r);var n=ve(r,e,e.dictionary?6:2,4);return le(n,e),$r(n,n.length-4,a.d()),n}function ue(r,e){return oe(r.subarray(se(r),-4),{i:2},e,e)}var Or=typeof TextEncoder<"u"&&new TextEncoder,Ar=typeof TextDecoder<"u"&&new TextDecoder,he=0;try{Ar.decode(Hr,{stream:!0}),he=1}catch{}var ge=function(r){for(var e="",a=0;;){var n=r[a++],t=(n>127)+(n>223)+(n>239);if(a+t>r.length)return{s:e,r:cr(r,a-1)};t?t==3?(n=((n&15)<<18|(r[a++]&63)<<12|(r[a++]&63)<<6|r[a++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):t&1?e+=String.fromCharCode((n&31)<<6|r[a++]&63):e+=String.fromCharCode((n&15)<<12|(r[a++]&63)<<6|r[a++]&63):e+=String.fromCharCode(n)}};function kr(r,e){if(e){for(var a=new T(r.length),n=0;n<r.length;++n)a[n]=r.charCodeAt(n);return a}if(Or)return Or.encode(r);for(var t=r.length,o=new T(r.length+(r.length>>1)),v=0,s=function(f){o[v++]=f},n=0;n<t;++n){if(v+5>o.length){var h=new T(v+8+(t-n<<1));h.set(o),o=h}var l=r.charCodeAt(n);l<128||e?s(l):l<2048?(s(192|l>>6),s(128|l&63)):l>55295&&l<57344?(l=65536+(l&1047552)|r.charCodeAt(++n)&1023,s(240|l>>18),s(128|l>>12&63),s(128|l>>6&63),s(128|l&63)):(s(224|l>>12),s(128|l>>6&63),s(128|l&63))}return cr(o,0,v)}function Ir(r,e){if(e){for(var a="",n=0;n<r.length;n+=16384)a+=String.fromCharCode.apply(null,r.subarray(n,n+16384));return a}else{if(Ar)return Ar.decode(r);var t=ge(r),o=t.s,a=t.r;return a.length&&B(8),o}}const Nr="heroicons:share",we="heroicons:check",Br="RAGBITS-STATE",Sr=`<${Br}>`,br=`</${Br}>`;function xe(r){if(typeof r!="object"||r===null)return!1;const e=r;return!(!Array.isArray(e.history)||"followupMessages"in e&&typeof e.followupMessages!="object"||"chatOptions"in e&&typeof e.chatOptions!="object"||"serverState"in e&&typeof e.serverState!="object"||"conversationId"in e&&typeof e.conversationId!="string"&&typeof e.conversationId!="object")}function be(){const{restore:r}=Gr(),{isOpen:e,onOpen:a,onClose:n}=Jr(),[t,o]=hr.useState(Nr),v=hr.useRef(null),s=()=>{const{chatOptions:l,history:f,serverState:i,conversationId:u,followupMessages:g}=Qr.getState(),b=Vr({chatOptions:l,history:Array.from(f.values()),serverState:i,conversationId:u,followupMessages:g}),x=kr(`${Sr}${JSON.stringify(b)}${br}`),S=btoa(Ir(ce(x,{level:9}),!0));navigator.clipboard.writeText(S),o(we),n(),v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{o(Nr)},2e3)},h=()=>{n()};return hr.useEffect(()=>{const l=f=>{if(!f.clipboardData||!f.clipboardData.types.includes("text/plain"))return;const u=f.clipboardData.getData("text/plain");try{const g=atob(u);if(!g.startsWith("xÚ"))return;const b=Ir(ue(kr(g,!0)));if(!b.startsWith(Sr)||!b.endsWith(br))return;f.preventDefault(),f.stopPropagation();const x=b.slice(Sr.length,-br.length),S=JSON.parse(x);if(!xe(S))return;r(S.history,S.followupMessages,S.chatOptions,S.serverState,S.conversationId)}catch(g){console.error("Couldn't parse pasted string as valid Ragbits state",g)}};return window.addEventListener("paste",l),()=>{window.removeEventListener("paste",l)}}),k.jsxs(k.Fragment,{children:[k.jsx(Wr,{content:"Share conversation",placement:"bottom",children:k.jsx(gr,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Share conversation",onPress:a,children:k.jsx(qr,{icon:t})})}),k.jsx(Yr,{isOpen:e,onOpenChange:h,children:k.jsx(Kr,{children:l=>k.jsxs(k.Fragment,{children:[k.jsx(Xr,{className:"text-default-900 flex flex-col gap-1",children:"Share conversation"}),k.jsx(Lr,{children:k.jsxs("div",{className:"flex flex-col gap-4",children:[k.jsx("p",{className:"text-medium text-default-500",children:"You are about to copy a code that allows sharing and storing your current app state. Once copied, you can paste this code anywhere on the site to instantly return to this exact setup. It’s a quick way to save your progress or share it with others."}),k.jsxs("div",{className:"flex justify-end gap-4 py-4",children:[k.jsx(gr,{color:"danger",variant:"light",onPress:l,"aria-label":"Close share modal",children:"Cancel"}),k.jsx(gr,{color:"primary",onPress:s,"aria-label":"Copy to clipboard to share the conversation",children:"Copy to clipboard"})]})]})})]})})})]})}export{be as default};
