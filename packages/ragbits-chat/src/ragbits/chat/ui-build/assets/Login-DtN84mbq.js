import{r as l,br as w,a as y,aP as S,aL as b,j as e,aF as j,aM as v,e as P,p as C}from"./index-CfqNPLkZ.js";import{a as N}from"./authStore-DTSzeeqX.js";import{i as c}from"./chunk-SSA7SXE4-BNiM8SGg.js";const q=()=>{const a=l.useContext(w);if(!a)throw new Error("useInitializeUserStore must be used within a HistoryStoreContextProvider");return a.initializeUserStore};function R(){const[a,m]=l.useState({username:"",password:""}),u=y("/api/auth/login",{headers:{"Content-Type":"application/json"},method:"POST"}),p=S(N,s=>s.login),g=b(),x=q(),[f,n]=l.useState(!1),h=async s=>{n(!1),s.preventDefault(),s.stopPropagation();const r=new FormData(s.currentTarget),o=r.get("username"),i=r.get("password");try{const t=await u.call({body:{username:o,password:i}});if(!t.success||!t.jwt_token||!t.user){n(!0);return}p(t.user,t.jwt_token),x(t.user.user_id),g("/")}catch(t){n(!0),console.error("Failed to login",t)}},d=s=>r=>m(o=>C(o,i=>{i[s]=r.target.value}));return e.jsx("div",{className:"flex h-screen w-screen",children:e.jsxs("form",{className:"rounded-medium border-small border-divider m-auto flex w-full max-w-xs flex-col gap-4 p-4",onSubmit:h,children:[e.jsxs("div",{className:"text-small",children:[e.jsx("div",{className:"text-foreground truncate leading-5 font-semibold",children:"Sign in"}),e.jsx("div",{className:"text-default-500 truncate leading-5 font-normal",children:"Sign in to start chatting."})]}),e.jsx(c,{label:"Username",name:"username",labelPlacement:"outside",placeholder:"Your username",required:!0,isRequired:!0,value:a.username,onChange:d("username")}),e.jsx(c,{label:"Password",labelPlacement:"outside",id:"password",name:"password",type:"password",placeholder:"••••••••",required:!0,isRequired:!0,value:a.password,onChange:d("password")}),e.jsx(j,{children:f&&!u.isLoading&&e.jsx(v.div,{className:"text-small text-danger",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3,ease:"easeOut"},children:"We couldn't sign you in. Please verify your credentials and try again."})}),e.jsx(P,{type:"submit",color:a.password&&a.username?"primary":"default",children:"Sign in"})]})})}export{R as default};
