import{r as hr,V as I,aA as gr,aB as Gr}from"./useThemeContext-CXEHnhK-.js";import{t as Jr,u as Wr,g as qr,D as Vr,m as Yr,d as Kr,e as Lr,v as Qr}from"./main-9MyF3y00.js";import{m as Xr}from"./chunk-IGSAU2ZA-DUsvhAfS.js";var T=Uint8Array,P=Uint16Array,Ar=Int32Array,lr=new T([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),sr=new T([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),mr=new T([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Nr=function(r,e){for(var a=new P(31),n=0;n<31;++n)a[n]=e+=1<<r[n-1];for(var t=new Ar(a[30]),n=1;n<30;++n)for(var o=a[n];o<a[n+1];++o)t[o]=o-a[n]<<5|n;return{b:a,r:t}},_r=Nr(lr,2),zr=_r.b,pr=_r.r;zr[28]=258,pr[258]=28;var Rr=Nr(sr,0),Zr=Rr.b,jr=Rr.r,Cr=new P(32768);for(var y=0;y<32768;++y){var L=(y&43690)>>1|(y&21845)<<1;L=(L&52428)>>2|(L&13107)<<2,L=(L&61680)>>4|(L&3855)<<4,Cr[y]=((L&65280)>>8|(L&255)<<8)>>1}var q=function(r,e,a){for(var n=r.length,t=0,o=new P(e);t<n;++t)r[t]&&++o[r[t]-1];var v=new P(e);for(t=1;t<e;++t)v[t]=v[t-1]+o[t-1]<<1;var l;if(a){l=new P(1<<e);var h=15-e;for(t=0;t<n;++t)if(r[t])for(var c=t<<4|r[t],f=e-r[t],i=v[r[t]-1]++<<f,u=i|(1<<f)-1;i<=u;++i)l[Cr[i]>>h]=c}else for(l=new P(n),t=0;t<n;++t)r[t]&&(l[t]=Cr[v[r[t]-1]++]>>15-r[t]);return l},Q=new T(288);for(var y=0;y<144;++y)Q[y]=8;for(var y=144;y<256;++y)Q[y]=9;for(var y=256;y<280;++y)Q[y]=7;for(var y=280;y<288;++y)Q[y]=8;var fr=new T(32);for(var y=0;y<32;++y)fr[y]=5;var re=q(Q,9,0),ee=q(Q,9,1),ae=q(fr,5,0),ne=q(fr,5,1),wr=function(r){for(var e=r[0],a=1;a<r.length;++a)r[a]>e&&(e=r[a]);return e},J=function(r,e,a){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&a},xr=function(r,e){var a=e/8|0;return(r[a]|r[a+1]<<8|r[a+2]<<16)>>(e&7)},Mr=function(r){return(r+7)/8|0},cr=function(r,e,a){return(e==null||e<0)&&(e=0),(a==null||a>r.length)&&(a=r.length),new T(r.subarray(e,a))},te=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],G=function(r,e,a){var n=new Error(e||te[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,G),!a)throw n;return n},oe=function(r,e,a,n){var t=r.length,o=0;if(!t||e.f&&!e.l)return a||new T(0);var v=!a,l=v||e.i!=2,h=e.i;v&&(a=new T(t*3));var c=function(ar){var nr=a.length;if(ar>nr){var rr=new T(Math.max(nr*2,ar));rr.set(a),a=rr}},f=e.f||0,i=e.p||0,u=e.b||0,x=e.l,S=e.d,w=e.m,d=e.n,p=t*8;do{if(!x){f=J(r,i,1);var R=J(r,i+1,3);if(i+=3,R)if(R==1)x=ee,S=ne,w=9,d=5;else if(R==2){var N=J(r,i,31)+257,M=J(r,i+10,15)+4,g=N+J(r,i+5,31)+1;i+=14;for(var s=new T(g),j=new T(19),C=0;C<M;++C)j[mr[C]]=J(r,i+C*3,7);i+=M*3;for(var k=wr(j),K=(1<<k)-1,U=q(j,k,1),C=0;C<g;){var _=U[J(r,i,K)];i+=_&15;var A=_>>4;if(A<16)s[C++]=A;else{var E=0,b=0;for(A==16?(b=3+J(r,i,3),i+=2,E=s[C-1]):A==17?(b=3+J(r,i,7),i+=3):A==18&&(b=11+J(r,i,127),i+=7);b--;)s[C++]=E}}var z=s.subarray(0,N),F=s.subarray(N);w=wr(z),d=wr(F),x=q(z,w,1),S=q(F,d,1)}else G(1);else{var A=Mr(i)+4,D=r[A-4]|r[A-3]<<8,O=A+D;if(O>t){h&&G(0);break}l&&c(u+D),a.set(r.subarray(A,O),u),e.b=u+=D,e.p=i=O*8,e.f=f;continue}if(i>p){h&&G(0);break}}l&&c(u+131072);for(var er=(1<<w)-1,$=(1<<d)-1,V=i;;V=i){var E=x[xr(r,i)&er],B=E>>4;if(i+=E&15,i>p){h&&G(0);break}if(E||G(2),B<256)a[u++]=B;else if(B==256){V=i,x=null;break}else{var H=B-254;if(B>264){var C=B-257,m=lr[C];H=J(r,i,(1<<m)-1)+zr[C],i+=m}var W=S[xr(r,i)&$],X=W>>4;W||G(3),i+=W&15;var F=Zr[X];if(X>3){var m=sr[X];F+=xr(r,i)&(1<<m)-1,i+=m}if(i>p){h&&G(0);break}l&&c(u+131072);var Z=u+H;if(u<F){var ir=o-F,vr=Math.min(F,Z);for(ir+u<0&&G(3);u<vr;++u)a[u]=n[ir+u]}for(;u<Z;++u)a[u]=a[u-F]}}e.l=x,e.p=V,e.b=u,e.f=f,x&&(f=1,e.m=w,e.d=S,e.n=d)}while(!f);return u!=a.length&&v?cr(a,0,u):a.subarray(0,u)},Y=function(r,e,a){a<<=e&7;var n=e/8|0;r[n]|=a,r[n+1]|=a>>8},tr=function(r,e,a){a<<=e&7;var n=e/8|0;r[n]|=a,r[n+1]|=a>>8,r[n+2]|=a>>16},yr=function(r,e){for(var a=[],n=0;n<r.length;++n)r[n]&&a.push({s:n,f:r[n]});var t=a.length,o=a.slice();if(!t)return{t:Br,l:0};if(t==1){var v=new T(a[0].s+1);return v[a[0].s]=1,{t:v,l:1}}a.sort(function(O,N){return O.f-N.f}),a.push({s:-1,f:25001});var l=a[0],h=a[1],c=0,f=1,i=2;for(a[0]={s:-1,f:l.f+h.f,l,r:h};f!=t-1;)l=a[a[c].f<a[i].f?c++:i++],h=a[c!=f&&a[c].f<a[i].f?c++:i++],a[f++]={s:-1,f:l.f+h.f,l,r:h};for(var u=o[0].s,n=1;n<t;++n)o[n].s>u&&(u=o[n].s);var x=new P(u+1),S=Tr(a[f-1],x,0);if(S>e){var n=0,w=0,d=S-e,p=1<<d;for(o.sort(function(N,M){return x[M.s]-x[N.s]||N.f-M.f});n<t;++n){var R=o[n].s;if(x[R]>e)w+=p-(1<<S-x[R]),x[R]=e;else break}for(w>>=d;w>0;){var A=o[n].s;x[A]<e?w-=1<<e-x[A]++-1:++n}for(;n>=0&&w;--n){var D=o[n].s;x[D]==e&&(--x[D],++w)}S=e}return{t:new T(x),l:S}},Tr=function(r,e,a){return r.s==-1?Math.max(Tr(r.l,e,a+1),Tr(r.r,e,a+1)):e[r.s]=a},Er=function(r){for(var e=r.length;e&&!r[--e];);for(var a=new P(++e),n=0,t=r[0],o=1,v=function(h){a[n++]=h},l=1;l<=e;++l)if(r[l]==t&&l!=e)++o;else{if(!t&&o>2){for(;o>138;o-=138)v(32754);o>2&&(v(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(v(t),--o;o>6;o-=6)v(8304);o>2&&(v(o-3<<5|8208),o=0)}for(;o--;)v(t);o=1,t=r[l]}return{c:a.subarray(0,n),n:e}},or=function(r,e){for(var a=0,n=0;n<e.length;++n)a+=r[n]*e[n];return a},Ur=function(r,e,a){var n=a.length,t=Mr(e+2);r[t]=n&255,r[t+1]=n>>8,r[t+2]=r[t]^255,r[t+3]=r[t+1]^255;for(var o=0;o<n;++o)r[t+o+4]=a[o];return(t+4+n)*8},Fr=function(r,e,a,n,t,o,v,l,h,c,f){Y(e,f++,a),++t[256];for(var i=yr(t,15),u=i.t,x=i.l,S=yr(o,15),w=S.t,d=S.l,p=Er(u),R=p.c,A=p.n,D=Er(w),O=D.c,N=D.n,M=new P(19),g=0;g<R.length;++g)++M[R[g]&31];for(var g=0;g<O.length;++g)++M[O[g]&31];for(var s=yr(M,7),j=s.t,C=s.l,k=19;k>4&&!j[mr[k-1]];--k);var K=c+5<<3,U=or(t,Q)+or(o,fr)+v,_=or(t,u)+or(o,w)+v+14+3*k+or(M,j)+2*M[16]+3*M[17]+7*M[18];if(h>=0&&K<=U&&K<=_)return Ur(e,f,r.subarray(h,h+c));var E,b,z,F;if(Y(e,f,1+(_<U)),f+=2,_<U){E=q(u,x,0),b=u,z=q(w,d,0),F=w;var er=q(j,C,0);Y(e,f,A-257),Y(e,f+5,N-1),Y(e,f+10,k-4),f+=14;for(var g=0;g<k;++g)Y(e,f+3*g,j[mr[g]]);f+=3*k;for(var $=[R,O],V=0;V<2;++V)for(var B=$[V],g=0;g<B.length;++g){var H=B[g]&31;Y(e,f,er[H]),f+=j[H],H>15&&(Y(e,f,B[g]>>5&127),f+=B[g]>>12)}}else E=re,b=Q,z=ae,F=fr;for(var g=0;g<l;++g){var m=n[g];if(m>255){var H=m>>18&31;tr(e,f,E[H+257]),f+=b[H+257],H>7&&(Y(e,f,m>>23&31),f+=lr[H]);var W=m&31;tr(e,f,z[W]),f+=F[W],W>3&&(tr(e,f,m>>5&8191),f+=sr[W])}else tr(e,f,E[m]),f+=b[m]}return tr(e,f,E[256]),f+b[256]},fe=new Ar([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Br=new T(0),ie=function(r,e,a,n,t,o){var v=o.z||r.length,l=new T(n+v+5*(1+Math.ceil(v/7e3))+t),h=l.subarray(n,l.length-t),c=o.l,f=(o.r||0)&7;if(e){f&&(h[0]=o.r>>3);for(var i=fe[e-1],u=i>>13,x=i&8191,S=(1<<a)-1,w=o.p||new P(32768),d=o.h||new P(S+1),p=Math.ceil(a/3),R=2*p,A=function(ur){return(r[ur]^r[ur+1]<<p^r[ur+2]<<R)&S},D=new Ar(25e3),O=new P(288),N=new P(32),M=0,g=0,s=o.i||0,j=0,C=o.w||0,k=0;s+2<v;++s){var K=A(s),U=s&32767,_=d[K];if(w[U]=_,d[K]=U,C<=s){var E=v-s;if((M>7e3||j>24576)&&(E>423||!c)){f=Fr(r,h,0,D,O,N,g,j,k,s-k,f),j=M=g=0,k=s;for(var b=0;b<286;++b)O[b]=0;for(var b=0;b<30;++b)N[b]=0}var z=2,F=0,er=x,$=U-_&32767;if(E>2&&K==A(s-$))for(var V=Math.min(u,E)-1,B=Math.min(32767,s),H=Math.min(258,E);$<=B&&--er&&U!=_;){if(r[s+z]==r[s+z-$]){for(var m=0;m<H&&r[s+m]==r[s+m-$];++m);if(m>z){if(z=m,F=$,m>V)break;for(var W=Math.min($,m-2),X=0,b=0;b<W;++b){var Z=s-$+b&32767,ir=w[Z],vr=Z-ir&32767;vr>X&&(X=vr,_=Z)}}}U=_,_=w[U],$+=U-_&32767}if(F){D[j++]=268435456|pr[z]<<18|jr[F];var ar=pr[z]&31,nr=jr[F]&31;g+=lr[ar]+sr[nr],++O[257+ar],++N[nr],C=s+z,++M}else D[j++]=r[s],++O[r[s]]}}for(s=Math.max(s,C);s<v;++s)D[j++]=r[s],++O[r[s]];f=Fr(r,h,c,D,O,N,g,j,k,s-k,f),c||(o.r=f&7|h[f/8|0]<<3,f-=7,o.h=d,o.p=w,o.i=s,o.w=C)}else{for(var s=o.w||0;s<v+c;s+=65535){var rr=s+65535;rr>=v&&(h[f/8|0]=c,rr=v),f=Ur(h,f+1,r.subarray(s,rr))}o.i=v}return cr(l,0,n+Mr(f)+t)},Hr=function(){var r=1,e=0;return{p:function(a){for(var n=r,t=e,o=a.length|0,v=0;v!=o;){for(var l=Math.min(v+2655,o);v<l;++v)t+=n+=a[v];n=(n&65535)+15*(n>>16),t=(t&65535)+15*(t>>16)}r=n,e=t},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},ve=function(r,e,a,n,t){if(!t&&(t={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),v=new T(o.length+r.length);v.set(o),v.set(r,o.length),r=v,t.w=o.length}return ie(r,e.level==null?6:e.level,e.mem==null?t.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,a,n,t)},Pr=function(r,e,a){for(;a;++e)r[e]=a,a>>>=8},le=function(r,e){var a=e.level,n=a==0?0:a<6?1:a==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var t=Hr();t.p(e.dictionary),Pr(r,2,t.d())}},se=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&G(6,"invalid zlib data"),(r[1]>>5&1)==1&&G(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function ce(r,e){e||(e={});var a=Hr();a.p(r);var n=ve(r,e,e.dictionary?6:2,4);return le(n,e),Pr(n,n.length-4,a.d()),n}function ue(r,e){return oe(r.subarray(se(r),-4),{i:2},e,e)}var Or=typeof TextEncoder<"u"&&new TextEncoder,dr=typeof TextDecoder<"u"&&new TextDecoder,he=0;try{dr.decode(Br,{stream:!0}),he=1}catch{}var ge=function(r){for(var e="",a=0;;){var n=r[a++],t=(n>127)+(n>223)+(n>239);if(a+t>r.length)return{s:e,r:cr(r,a-1)};t?t==3?(n=((n&15)<<18|(r[a++]&63)<<12|(r[a++]&63)<<6|r[a++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):t&1?e+=String.fromCharCode((n&31)<<6|r[a++]&63):e+=String.fromCharCode((n&15)<<12|(r[a++]&63)<<6|r[a++]&63):e+=String.fromCharCode(n)}};function kr(r,e){if(e){for(var a=new T(r.length),n=0;n<r.length;++n)a[n]=r.charCodeAt(n);return a}if(Or)return Or.encode(r);for(var t=r.length,o=new T(r.length+(r.length>>1)),v=0,l=function(f){o[v++]=f},n=0;n<t;++n){if(v+5>o.length){var h=new T(v+8+(t-n<<1));h.set(o),o=h}var c=r.charCodeAt(n);c<128||e?l(c):c<2048?(l(192|c>>6),l(128|c&63)):c>55295&&c<57344?(c=65536+(c&1047552)|r.charCodeAt(++n)&1023,l(240|c>>18),l(128|c>>12&63),l(128|c>>6&63),l(128|c&63)):(l(224|c>>12),l(128|c>>6&63),l(128|c&63))}return cr(o,0,v)}function Ir(r,e){if(e){for(var a="",n=0;n<r.length;n+=16384)a+=String.fromCharCode.apply(null,r.subarray(n,n+16384));return a}else{if(dr)return dr.decode(r);var t=ge(r),o=t.s,a=t.r;return a.length&&G(8),o}}const Dr="heroicons:share",we="heroicons:check",$r="RAGBITS-STATE",Sr=`<${$r}>`,br=`</${$r}>`;function xe(r){if(typeof r!="object"||r===null)return!1;const e=r;return!(typeof e.history!="object"||"followupMessages"in e&&typeof e.followupMessages!="object"||"chatOptions"in e&&typeof e.chatOptions!="object"||"serverState"in e&&typeof e.serverState!="object"||"conversationId"in e&&typeof e.conversationId!="string"&&typeof e.conversationId!="object")}function me(){const{restore:r}=Jr(),{isOpen:e,onOpen:a,onClose:n}=Wr(),[t,o]=hr.useState(Dr),v=hr.useRef(null),{getCurrentConversation:l}=qr(f=>f.primitives),h=()=>{const{chatOptions:f,history:i,serverState:u,conversationId:x,followupMessages:S}=l(),w=Qr({chatOptions:f,history:i,serverState:u,conversationId:x,followupMessages:S}),d=kr(`${Sr}${JSON.stringify(w)}${br}`),p=btoa(Ir(ce(d,{level:9}),!0));navigator.clipboard.writeText(p),o(we),n(),v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{o(Dr)},2e3)},c=()=>{n()};return hr.useEffect(()=>{const f=i=>{if(!i.clipboardData)return;const u=i.clipboardData.types;if(!u.includes("text/plain")&&!u.includes("text"))return;const x=i.clipboardData.getData("text/plain")??i.clipboardData.getData("text");try{const S=atob(x);if(!S.startsWith("xÚ"))return;const w=Ir(ue(kr(S,!0)));if(!w.startsWith(Sr)||!w.endsWith(br))return;i.preventDefault(),i.stopPropagation();const d=w.slice(Sr.length,-br.length),p=JSON.parse(d);if(!xe(p))return;r(p.history,p.followupMessages,p.chatOptions,p.serverState,p.conversationId)}catch(S){console.error("Couldn't parse pasted string as valid Ragbits state",S)}};return window.addEventListener("paste",f),()=>{window.removeEventListener("paste",f)}}),I.jsxs(I.Fragment,{children:[I.jsx(Vr,{content:"Share conversation",placement:"bottom",children:I.jsx(gr,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Share conversation",onPress:a,children:I.jsx(Gr,{icon:t})})}),I.jsx(Yr,{isOpen:e,onOpenChange:c,children:I.jsx(Kr,{children:f=>I.jsxs(I.Fragment,{children:[I.jsx(Xr,{className:"text-default-900 flex flex-col gap-1",children:"Share conversation"}),I.jsx(Lr,{children:I.jsxs("div",{className:"flex flex-col gap-4",children:[I.jsx("p",{className:"text-medium text-default-500",children:"You are about to copy a code that allows sharing and storing your current app state. Once copied, you can paste this code anywhere on the site to instantly return to this exact setup. It’s a quick way to save your progress or share it with others."}),I.jsxs("div",{className:"flex justify-end gap-4 py-4",children:[I.jsx(gr,{color:"danger",variant:"light",onPress:f,"aria-label":"Close share modal",children:"Cancel"}),I.jsx(gr,{color:"primary",onPress:h,"aria-label":"Copy to clipboard to share the conversation",children:"Copy to clipboard"})]})]})})]})})})]})}export{me as default};
