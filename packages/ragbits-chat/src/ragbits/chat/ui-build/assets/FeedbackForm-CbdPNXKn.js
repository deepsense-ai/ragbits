import{u as v,a as E,r as C,F as s,b as S,j as e,D as b,c as o,I as h}from"./index-Xs_PpRSD.js";import{u as T,a as _,m as w,b as D,c as O,d as L,F as K,v as N}from"./index-DjCR3PvF.js";function A({message:t}){var u;const{isOpen:f,onOpen:p,onClose:i}=T(),{mergeExtensions:x}=v(),{config:{feedback:n}}=E(),[l,k]=C.useState(s.LIKE),j=S("/api/feedback",{headers:{"Content-Type":"application/json"},method:"POST"}),r=n[l].form,y=()=>{i()},c=async a=>{if(!t.serverId)throw new Error('Feedback is only available for messages with "serverId" set');try{await j.call({body:{message_id:t.serverId,feedback:l,payload:a}})}catch(I){console.error(I)}},F=a=>{x(t.id,{feedbackType:l}),c(a.formData),i()},d=async a=>{if(k(a),n[a].form===null){await c(null);return}p()},g=_();if(!r)return null;const m=(u=t.extensions)==null?void 0:u.feedbackType;return e.jsxs(e.Fragment,{children:[n.like.enabled&&e.jsx(b,{content:"Like",placement:"bottom",children:e.jsx(o,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Rate message as helpful",onPress:()=>d(s.LIKE),"data-testid":"feedback-like",children:e.jsx(h,{icon:m===s.LIKE?"heroicons:hand-thumb-up-solid":"heroicons:hand-thumb-up"})})}),n.dislike.enabled&&e.jsx(b,{content:"Dislike",placement:"bottom",children:e.jsx(o,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Rate message as unhelpful",onPress:()=>d(s.DISLIKE),"data-testid":"feedback-dislike",children:e.jsx(h,{icon:m===s.DISLIKE?"heroicons:hand-thumb-down-solid":"heroicons:hand-thumb-down"})})}),e.jsx(w,{isOpen:f,onOpenChange:y,children:e.jsx(D,{children:a=>e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"flex flex-col gap-1 text-default-900",children:r.title}),e.jsx(L,{children:e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(K,{schema:r,validator:N,onSubmit:F,transformErrors:g,liveValidate:!0,children:e.jsxs("div",{className:"flex justify-end gap-4 py-4",children:[e.jsx(o,{color:"danger",variant:"light",onPress:a,"aria-label":"Close feedback form",children:"Cancel"}),e.jsx(o,{color:"primary",type:"submit","aria-label":"Submit feedback","data-testid":"feedback-submit",children:"Submit"})]})})})})]})})})]})}export{A as default};
