import{r as s,j as a,br as x,aN as h,h as g,aJ as m,bs as p,bt as v}from"./index-CZzdpmLT.js";import{a as u}from"./authStore-B_PRYMfQ.js";function j({children:e}){const[o]=s.useState(()=>u);return a.jsx(x.Provider,{value:o,children:e})}function A(){const{token:e,tokenExpiration:o,logout:r}=h(u,t=>t),n=g(t=>t.isLoading),c=m(),l=s.useRef(n);s.useEffect(()=>{l.current=n},[n]);const i=s.useCallback(()=>{const t=()=>{l.current?setTimeout(t,500):(r(),c("/login"))};t()},[r,c]);return s.useEffect(()=>{if(!e||!o)return;const t=Date.now(),f=o-t;if(f<=0){i();return}const d=setTimeout(()=>{i()},f);return()=>clearTimeout(d)},[e,o,i]),null}function S({children:e}){const o=p(),r=h(u,n=>n.isAuthenticated);return o.pathname==="/login"?e:r?a.jsxs(j,{children:[e,a.jsx(A,{})]}):a.jsx(v,{to:"/login",replace:!0})}export{S as default};
