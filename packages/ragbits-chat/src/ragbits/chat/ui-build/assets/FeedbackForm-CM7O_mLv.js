import{u as g,r as F,F as l,a as C,j as e,D as d,b as t,I as m}from"./index-KfigCE19.js";import{u as _,a as v,m as I,b as S,c as T,d as E,F as O,v as D}from"./index-B3YF_38w.js";function P({messageServerId:u}){const{isOpen:b,onOpen:f,onClose:o}=_(),{config:{feedback:s}}=g(),[r,h]=F.useState(l.LIKE),p=C("/api/feedback",{headers:{"Content-Type":"application/json"},method:"POST"}),n=s[r].form,x=()=>{o()},c=async a=>{try{await p.call({body:{message_id:u,feedback:r,payload:a}})}catch(y){console.error(y)}},j=a=>{c(a.formData),o()},i=async a=>{if(h(a),s[a].form===null){await c(null);return}f()},k=v();return n?e.jsxs(e.Fragment,{children:[s.like.enabled&&e.jsx(d,{content:"Like",placement:"bottom",children:e.jsx(t,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Rate message as helpful",onPress:()=>i(l.LIKE),"data-testid":"feedback-like",children:e.jsx(m,{icon:"heroicons:hand-thumb-up"})})}),s.dislike.enabled&&e.jsx(d,{content:"Dislike",placement:"bottom",children:e.jsx(t,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Rate message as unhelpful",onPress:()=>i(l.DISLIKE),"data-testid":"feedback-dislike",children:e.jsx(m,{icon:"heroicons:hand-thumb-down"})})}),e.jsx(I,{isOpen:b,onOpenChange:x,children:e.jsx(S,{children:a=>e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"flex flex-col gap-1 text-default-900",children:n.title}),e.jsx(E,{children:e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(O,{schema:n,validator:D,onSubmit:j,transformErrors:k,liveValidate:!0,children:e.jsxs("div",{className:"flex justify-end gap-4 py-4",children:[e.jsx(t,{color:"danger",variant:"light",onPress:a,"aria-label":"Close feedback form",children:"Cancel"}),e.jsx(t,{color:"primary",type:"submit","aria-label":"Submit feedback","data-testid":"feedback-submit",children:"Submit"})]})})})})]})})})]}):null}export{P as default};
