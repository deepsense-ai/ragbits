import{u as g,r as y,a as F,j as e,D as c,b as t,I as d}from"./index-CRvk5qNz.js";import{u as _,a as C,m as v,b as O,c as S,d as T,F as D,v as N}from"./index-Cg0SkF72.js";function P({messageServerId:m}){const{isOpen:u,onOpen:b,onClose:n}=_(),{config:{feedback:s}}=g(),[o,f]=y.useState("like"),h=F("/api/feedback",{headers:{"Content-Type":"application/json"},method:"POST"}),l=s[`${o}_form`],p=()=>{n()},r=async a=>{try{await h.call({body:{message_id:m,feedback:o,payload:a}})}catch(j){console.error(j)}},x=a=>{r(a.formData),n()},i=async a=>{if(f(a),s[`${a}_form`]===null){await r(null);return}b()},k=C();return l?e.jsxs(e.Fragment,{children:[s.like.enabled&&e.jsx(c,{content:"Like",placement:"bottom",children:e.jsx(t,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Rate message as helpful",onPress:()=>i("like"),"data-testid":"feedback-like",children:e.jsx(d,{icon:"heroicons:hand-thumb-up"})})}),s.dislike.enabled&&e.jsx(c,{content:"Dislike",placement:"bottom",children:e.jsx(t,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Rate message as unhelpful",onPress:()=>i("dislike"),"data-testid":"feedback-dislike",children:e.jsx(d,{icon:"heroicons:hand-thumb-down"})})}),e.jsx(v,{isOpen:u,onOpenChange:p,children:e.jsx(O,{children:a=>e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"flex flex-col gap-1 text-default-900",children:l.title??"Feedback"}),e.jsx(T,{children:e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(D,{schema:l,validator:N,onSubmit:x,transformErrors:k,liveValidate:!0,children:e.jsxs("div",{className:"flex justify-end gap-4 py-4",children:[e.jsx(t,{color:"danger",variant:"light",onPress:a,"aria-label":"Close feedback form",children:"Cancel"}),e.jsx(t,{color:"primary",type:"submit","aria-label":"Submit feedback","data-testid":"feedback-submit",children:"Submit"})]})})})})]})})})]}):null}export{P as default};
