import{ai as A,r as n,E as t,H as K,a7 as c,a8 as i}from"./useThemeContext-DkrqKvLn.js";import{a as V,e as u,h as w,m,D as y,l as W,i as F,j as C}from"./main-BJLJjzL4.js";import{i as G}from"./chunk-SSA7SXE4-BswVq7lY.js";import{d as J,a as L,b as M,m as N}from"./chunk-XHRYXXZA-eia5gCmD.js";import"./useMenuTriggerState-DfYBgrZh.js";import"./useSelectableItem-BR0VPP-3.js";function te(){const{selectConversation:E,deleteConversation:S,newConversation:_,setConversationProperties:$}=V(),h=A(),P=u(w(e=>Object.keys(e.conversations).reverse())),I=u(w(e=>Object.values(e.conversations).reverse().map(s=>s.summary))),O=u(e=>e.currentConversation),[a,B]=n.useState(!1),[f,d]=n.useState(null),[p,o]=n.useState(""),[T,l]=n.useState(!1),x=n.useRef(null),v=a?"Open sidebar":"Close sidebar",D=t.jsx(i,{icon:"heroicons:pencil-square"}),H=(e,s)=>{d(e),o(s??""),l(!0),setTimeout(()=>{x.current?.focus?.(),setTimeout(()=>l(!1),120)},0)},j=e=>{if(f!==e)return;const s=(p||"").trim();s&&$(e,{summary:s}),d(null),o(""),l(!1)},R=()=>{d(null),o(""),l(!1)},k=()=>{const e=_();h(C(e))},q=e=>{E(e),h(C(e))};return t.jsx(m.div,{initial:!1,animate:{maxWidth:a?"4.5rem":"16rem"},className:"rounded-l-medium border-small border-divider ml-4 flex h-full w-full min-w-[4.5rem] flex-grow flex-col space-y-2 overflow-hidden border-r-0 p-4 py-3",children:t.jsxs(K,{children:[t.jsx(y,{content:v,placement:"bottom",children:t.jsx(c,{isIconOnly:!0,"aria-label":v,variant:"ghost",onPress:()=>B(e=>!e),"data-testid":"chat-history-collapse-button",className:"ml-auto",children:t.jsx(i,{icon:a?"heroicons:chevron-double-right":"heroicons:chevron-double-left"})})},"collapse-button"),!a&&t.jsx(m.p,{initial:!1,animate:{opacity:1,width:"100%",height:"auto"},exit:{opacity:0,width:0,height:0,marginBottom:0},className:"text-small text-foreground truncate leading-5 font-semibold",children:"Conversations"},"conversations"),t.jsx(y,{content:"New conversation",placement:"right",children:t.jsx(c,{"aria-label":"New conversation",variant:"ghost",onPress:k,"data-testid":"chat-history-clear-chat-button",startContent:D,isIconOnly:a,children:!a&&"New conversation"})},"new-conversation-button"),!a&&t.jsx(m.div,{className:"mt-2 flex flex-1 flex-col gap-2 overflow-auto overflow-x-hidden",initial:!1,animate:{opacity:1,width:"100%"},exit:{opacity:0,width:0},children:W.zip(P,I).map(([e,s])=>{if(!e||F(e))return null;const g=e===O,z=e===f,b=g?"solid":"light";return t.jsxs("div",{className:"flex w-full justify-between gap-2",children:[z?t.jsx(G,{ref:x,size:"sm",variant:"bordered",value:p,onChange:r=>o(r.target.value),onBlur:()=>{T||j(e)},onKeyDown:r=>{r.key==="Enter"&&j(e),r.key==="Escape"&&R()},className:"flex-1","data-testid":`input-conversation-${e}`}):t.jsx(c,{variant:b,"aria-label":`Select conversation ${e}`,"data-active":g,onPress:()=>q(e),title:s??e,"data-testid":`select-conversation-${e}`,className:"flex-1 justify-start",children:t.jsx("div",{className:"text-small truncate",children:s??e})}),t.jsxs(J,{children:[t.jsx(L,{children:t.jsx(c,{isIconOnly:!0,variant:"light","aria-label":`Conversation actions for ${e}`,"data-testid":`dropdown-conversation-${e}`,children:t.jsx(i,{icon:"heroicons:ellipsis-vertical",className:"rotate-90"})})}),t.jsxs(M,{"aria-label":"Conversation actions",children:[t.jsx(N,{startContent:t.jsx(i,{icon:"heroicons:pencil-square",className:"mb-0.5"}),onPress:()=>H(e,s??e),"data-testid":`edit-conversation-${e}`,children:"Edit"},"edit"),t.jsx(N,{className:"text-danger mb-0.5",color:"danger",startContent:t.jsx(i,{icon:"heroicons:trash"}),onPress:()=>S(e),"data-testid":`delete-conversation-${e}`,children:"Delete conversation"},"delete")]})]})]},`${e}-${b}`)})},"conversation-list")]})})}export{te as default};
