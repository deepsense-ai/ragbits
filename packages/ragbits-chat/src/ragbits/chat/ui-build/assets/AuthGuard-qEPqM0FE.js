import{r as s,j as r,a$ as x,aZ as h,h as g,aV as m,b0 as p,b1 as v}from"./index-ARGH7eR7.js";import{a as u}from"./authStore-DKD7laAE.js";function j({children:e}){const[o]=s.useState(()=>u);return r.jsx(x.Provider,{value:o,children:e})}function A(){const{token:e,tokenExpiration:o,logout:a}=h(u,t=>t),n=g(t=>t.isLoading),c=m(),l=s.useRef(n);s.useEffect(()=>{l.current=n},[n]);const i=s.useCallback(()=>{const t=()=>{l.current?setTimeout(t,500):(a(),c("/login"))};t()},[a,c]);return s.useEffect(()=>{if(!e||!o)return;const t=Date.now(),f=o-t;if(f<=0){i();return}const d=setTimeout(()=>{i()},f);return()=>clearTimeout(d)},[e,o,i]),null}function S({children:e}){const o=p(),a=h(u,n=>n.isAuthenticated);return o.pathname==="/login"?e:a?r.jsxs(j,{children:[e,r.jsx(A,{})]}):r.jsx(v,{to:"/login",replace:!0})}export{S as default};
