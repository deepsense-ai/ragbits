import{r as P,aX as V,bf as j,U as O,bg as J,aU as N,J as F,ay as X,K as _,b5 as q,bh as z,bi as Q,bj as W,bk as Y,bl as Z}from"./index-Cyzr1kIj.js";let ee=0;const E=new Map;function te(r){let[u,t]=P.useState();return V(()=>{if(!r)return;let o=E.get(r);if(o)t(o.element.id);else{let s=`react-aria-description-${ee++}`;t(s);let d=document.createElement("div");d.id=s,d.style.display="none",d.textContent=r,document.body.appendChild(d),o={refCount:0,element:d},E.set(r,o)}return o.refCount++,()=>{o&&--o.refCount===0&&(o.element.remove(),E.delete(r))}},[r]),{"aria-describedby":r?u:void 0}}const oe=500;function re(r){let{isDisabled:u,onLongPressStart:t,onLongPressEnd:o,onLongPress:s,threshold:d=oe,accessibilityDescription:f}=r;const b=P.useRef(void 0);let{addGlobalListener:i,removeGlobalListener:g}=j(),{pressProps:D}=O({isDisabled:u,onPressStart(n){if(n.continuePropagation(),(n.pointerType==="mouse"||n.pointerType==="touch")&&(t&&t({...n,type:"longpressstart"}),b.current=setTimeout(()=>{n.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),J(n.target).activeElement!==n.target&&N(n.target),s&&s({...n,type:"longpress"}),b.current=void 0},d),n.pointerType==="touch")){let l=y=>{y.preventDefault()};i(n.target,"contextmenu",l,{once:!0}),i(window,"pointerup",()=>{setTimeout(()=>{g(n.target,"contextmenu",l)},30)},{once:!0})}},onPressEnd(n){b.current&&clearTimeout(b.current),o&&(n.pointerType==="mouse"||n.pointerType==="touch")&&o({...n,type:"longpressend"})}}),p=te(s&&!u?f:void 0);return{longPressProps:F(D,p)}}function se(r){let{id:u,selectionManager:t,key:o,ref:s,shouldSelectOnPressUp:d,shouldUseVirtualFocus:f,focus:b,isDisabled:i,onAction:g,allowsDifferentPressOrigin:D,linkBehavior:p="action"}=r,n=X();u=_(u);let l=e=>{if(e.pointerType==="keyboard"&&Y(e))t.toggleSelection(o);else{if(t.selectionMode==="none")return;if(t.isLink(o)){if(p==="selection"&&s.current){let v=t.getItemProps(o);n.open(s.current,e,v.href,v.routerOptions),t.setSelectedKeys(t.selectedKeys);return}else if(p==="override"||p==="none")return}t.selectionMode==="single"?t.isSelected(o)&&!t.disallowEmptySelection?t.toggleSelection(o):t.replaceSelection(o):e&&e.shiftKey?t.extendSelection(o):t.selectionBehavior==="toggle"||e&&(Z(e)||e.pointerType==="touch"||e.pointerType==="virtual")?t.toggleSelection(o):t.replaceSelection(o)}};P.useEffect(()=>{o===t.focusedKey&&t.isFocused&&(f?z(s.current):b?b():document.activeElement!==s.current&&s.current&&q(s.current))},[s,o,t.focusedKey,t.childFocusStrategy,t.isFocused,f]),i=i||t.isDisabled(o);let y={};!f&&!i?y={tabIndex:o===t.focusedKey?0:-1,onFocus(e){e.target===s.current&&t.setFocusedKey(o)}}:i&&(y.onMouseDown=e=>{e.preventDefault()});let U=t.isLink(o)&&p==="override",w=t.isLink(o)&&p!=="selection"&&p!=="none",a=!i&&t.canSelectItem(o)&&!U,k=(g||w)&&!i,$=k&&(t.selectionBehavior==="replace"?!a:!a||t.isEmpty),x=k&&a&&t.selectionBehavior==="replace",m=$||x,h=P.useRef(null),S=m&&a,L=P.useRef(!1),K=P.useRef(!1),T=e=>{if(g&&g(),w&&s.current){let v=t.getItemProps(o);n.open(s.current,e,v.href,v.routerOptions)}},c={ref:s};d?(c.onPressStart=e=>{h.current=e.pointerType,L.current=S,e.pointerType==="keyboard"&&(!m||C())&&l(e)},D?(c.onPressUp=$?void 0:e=>{e.pointerType==="mouse"&&a&&l(e)},c.onPress=$?T:e=>{e.pointerType!=="keyboard"&&e.pointerType!=="mouse"&&a&&l(e)}):c.onPress=e=>{if($||x&&e.pointerType!=="mouse"){if(e.pointerType==="keyboard"&&!A())return;T(e)}else e.pointerType!=="keyboard"&&a&&l(e)}):(c.onPressStart=e=>{h.current=e.pointerType,L.current=S,K.current=$,a&&(e.pointerType==="mouse"&&!$||e.pointerType==="keyboard"&&(!k||C()))&&l(e)},c.onPress=e=>{(e.pointerType==="touch"||e.pointerType==="pen"||e.pointerType==="virtual"||e.pointerType==="keyboard"&&m&&A()||e.pointerType==="mouse"&&K.current)&&(m?T(e):a&&l(e))}),y["data-collection"]=Q(t.collection),y["data-key"]=o,c.preventFocusOnPress=f,f&&(c=F(c,{onPressStart(e){e.pointerType!=="touch"&&(t.setFocused(!0),t.setFocusedKey(o))},onPress(e){e.pointerType==="touch"&&(t.setFocused(!0),t.setFocusedKey(o))}}));let{pressProps:M,isPressed:B}=O(c),I=x?e=>{h.current==="mouse"&&(e.stopPropagation(),e.preventDefault(),T(e))}:void 0,{longPressProps:R}=re({isDisabled:!S,onLongPress(e){e.pointerType==="touch"&&(l(e),t.setSelectionBehavior("toggle"))}}),G=e=>{h.current==="touch"&&L.current&&e.preventDefault()},H=t.isLink(o)?e=>{W.isOpening||e.preventDefault()}:void 0;return{itemProps:F(y,a||$||f&&!i?M:{},S?R:{},{onDoubleClick:I,onDragStartCapture:G,onClick:H,id:u},f?{onMouseDown:e=>e.preventDefault()}:void 0),isPressed:B,isSelected:t.isSelected(o),isFocused:t.isFocused&&t.focusedKey===o,isDisabled:i,allowsSelection:a,hasAction:m}}function A(){let r=window.event;return r?.key==="Enter"}function C(){let r=window.event;return r?.key===" "||r?.code==="Space"}export{se as $,re as a,te as b};
