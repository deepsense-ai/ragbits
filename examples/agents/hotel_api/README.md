# Hotel API Example

Simple FastAPI service that exposes hotel availability and reservation endpoints backed by a local SQLite database. It demonstrates how to manage inventory from a JSON configuration file and provides helper routes to list availability, place reservations (optionally with breakfast), and reset the system back to the configured state.

## Project Layout

- `app.py` – FastAPI application, database models, and API routes.
- `hotel_config.json` – Source of truth for hotels, rooms, and the 2025 availability windows.
- `hotel.db` – SQLite database file created on first start; regenerated by the reset endpoint.

## Prerequisites

- Python 3.11+
- [`uv`](https://github.com/astral-sh/uv) (same tool used across this repository)

Install the example's dependencies (FastAPI and Uvicorn are already part of the workspace). If you are running in a fresh environment:

```bash
uv sync
```

## Running the API

From the repository root:

```bash
uv run uvicorn examples.agents.hotel_api.app:app --reload --port 8000
```

When the service starts it will:

1. Create `examples/agents/hotel_api/hotel.db` (if missing).
2. Load `hotel_config.json`.
3. Populate the database with the configured availability for Warsaw, Lodz, and Sosnowiec (10 rooms each).

## Configuration

`hotel_config.json` is the single place to audit or edit availability. For each hotel you can list any number of rooms and attach date ranges they can be booked for. The API rebuilds the database from this file whenever `/reset` is called, so edits take effect immediately after a reset.

```json
{
  "name": "Warsaw",
  "rooms": [
    {
      "number": "101",
      "availability": [
        { "start": "2025-02-12", "end": "2025-02-16" },
        { "start": "2025-03-30", "end": "2025-03-31" }
      ]
    }
  ]
}
```

## REST API

- `GET /hotels` – List all hotel names.
- `GET /availability?hotel=Warsaw&start_date=2025-07-10&end_date=2025-07-14` – View available rooms and consolidated availability windows inside the requested range.
- `POST /reservations` – Create a booking with optional breakfast (`include_breakfast` flag). Blocks the selected room for each night in the range.
- `GET /reservations` – Inspect existing reservations.
- `DELETE /reservations/{reservation_id}` – Cancel a specific reservation and free the room.
- `POST /reset` – Drop and rebuild the database from `hotel_config.json`, clearing all reservations.

### Example: Check Availability

```bash
curl "http://127.0.0.1:8000/availability?hotel=Lodz&start_date=2025-07-09&end_date=2025-07-13"
```

### Example: Create Reservation (with breakfast)

```bash
curl -X POST "http://127.0.0.1:8000/reservations" \
  -H "Content-Type: application/json" \
  -d '{
        "hotel": "Warsaw",
        "room_number": "101",
        "guest_name": "Jane Doe",
        "start_date": "2025-07-10",
        "end_date": "2025-07-12",
        "include_breakfast": true
      }'
```

### Example: Reset System

```bash
curl -X POST "http://127.0.0.1:8000/reset"
```

## Notes

- Date inputs must be ISO formatted (`YYYY-MM-DD`).
- Reservations require full availability coverage; partial overlaps are rejected.
- The breakfast flag is stored with each reservation and returned from listing endpoints.
- Because SQLite is used, the database file lives alongside the example scripts and is easily portable.

