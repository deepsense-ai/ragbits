import{u as F,a as v,b as C,r as _,c as T,j as e,D as m,d as o,I as u,m as w,e as I,f as O}from"./index-oqhosA0l.js";import{u as S,F as E,v as D}from"./index-DmQxvcK3.js";import{m as N}from"./chunk-IGSAU2ZA-B4HzSPzF.js";function H({message:s}){const{isOpen:f,onOpen:b,onClose:r}=F(),{mergeExtensions:h}=v(),{config:{feedback:t}}=C(),[n,p]=_.useState("like"),x=T("/api/feedback",{headers:{"Content-Type":"application/json"},method:"POST"}),l=t[n].form,k=()=>{r()},i=async a=>{if(!s.serverId)throw new Error('Feedback is only available for messages with "serverId" set');try{await x.call({body:{message_id:s.serverId,feedback:n,payload:a??{}}})}catch(g){console.error(g)}},j=a=>{h(s.id,{feedbackType:n}),i(a.formData),r()},c=async a=>{if(p(a),t[a].form===null){await i(null);return}b()},y=S();if(!l)return null;const d=s.extensions?.feedbackType;return e.jsxs(e.Fragment,{children:[t.like.enabled&&e.jsx(m,{content:"Like",placement:"bottom",children:e.jsx(o,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Rate message as helpful",onPress:()=>c("like"),"data-testid":"feedback-like",children:e.jsx(u,{icon:d==="like"?"heroicons:hand-thumb-up-solid":"heroicons:hand-thumb-up"})})}),t.dislike.enabled&&e.jsx(m,{content:"Dislike",placement:"bottom",children:e.jsx(o,{isIconOnly:!0,variant:"ghost",className:"p-0","aria-label":"Rate message as unhelpful",onPress:()=>c("dislike"),"data-testid":"feedback-dislike",children:e.jsx(u,{icon:d==="dislike"?"heroicons:hand-thumb-down-solid":"heroicons:hand-thumb-down"})})}),e.jsx(w,{isOpen:f,onOpenChange:k,children:e.jsx(I,{children:a=>e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"text-default-900 flex flex-col gap-1",children:l.title}),e.jsx(O,{children:e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(E,{schema:l,validator:D,onSubmit:j,transformErrors:y,liveValidate:!0,children:e.jsxs("div",{className:"flex justify-end gap-4 py-4",children:[e.jsx(o,{color:"danger",variant:"light",onPress:a,"aria-label":"Close feedback form",children:"Cancel"}),e.jsx(o,{color:"primary",type:"submit","aria-label":"Submit feedback","data-testid":"feedback-submit",children:"Submit"})]})})})})]})})})]})}export{H as default};
